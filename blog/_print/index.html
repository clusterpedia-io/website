<!doctype html><html lang=en class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.91.2">
<link rel=canonical type=text/html href=/blog/>
<meta name=robots content="noindex, nofollow">
<link rel="shortcut icon" href=/favicons/favicon.ico>
<link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192>
<title>Blog | Clusterpedia.io</title>
<meta name=description content>
<meta property="og:title" content="Blog">
<meta property="og:description" content="Clusterpedia.io website">
<meta property="og:type" content="website">
<meta property="og:url" content="/blog/"><meta property="og:site_name" content="Clusterpedia.io">
<meta itemprop=name content="Blog">
<meta itemprop=description content="Clusterpedia.io website"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Blog">
<meta name=twitter:description content="Clusterpedia.io website">
<link rel=preload href=/scss/main.min.9961c751547efda0481dd5723ad2db290629eb1181b4dd88454b106a6737233e.css as=style>
<link href=/scss/main.min.9961c751547efda0481dd5723ad2db290629eb1181b4dd88454b106a6737233e.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script>
<link href=https://cdn.bootcdn.net/ajax/libs/asciinema-player/2.6.1/asciinema-player.min.css rel=stylesheet>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NZQPMJ4HH3"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-NZQPMJ4HH3',{anonymize_ip:!1})}</script>
</head>
<body class="td-section td-blog">
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/>
<span class=navbar-logo><svg id="Graph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g id="Cpedia_-_Graph_-_Color_Dark" data-name="Cpedia - Graph - Color Dark"><rect id="Frame" width="512" height="512" fill="none"/><path id="Secondary" d="M476 221.051A274.908 274.908.0 00428.269 256 282.438 282.438.0 01395.7 220.752a322.971 322.971.0 0156.3-41.27zM362.4 256a334.139 334.139.0 00-53.2 92.145A329.953 329.953.0 00295.32 394.6a322.932 322.932.0 00-7.587 69.4h48a274.957 274.957.0 016.4-58.813 282.32 282.32.0 0114.238-45.835 285.94 285.94.0 0139.323-68.1A330.2 330.2.0 01362.4 256zM169.865 405.189a274.9 274.9.0 016.4 58.811h48a322.893 322.893.0 00-7.589-69.4 282.46 282.46.0 00-46.811 10.589zM179.94 300.03A333.961 333.961.0 00149.6 256a330 330 0 00-33.291-35.248A322.915 322.915.0 0060 179.482L36 221.051A274.964 274.964.0 0183.733 256a282.3 282.3.0 0132.576 35.248 286.331 286.331.0 0122.054 32.768 286.3 286.3.0 0117.264 35.339A330.144 330.144.0 01202.8 348.148 334.156 334.156.0 00179.94 300.03zM169.865 106.811a274.966 274.966.0 01-54.132-23.862l-24 41.569a322.934 322.934.0 0063.894 28.127 282.241 282.241.0 0014.238-45.834zm186.507 45.836a322.994 322.994.0 0063.895-28.129l-24-41.569a275.02 275.02.0 01-54.133 23.864A282.293 282.293.0 01295.32 117.4a286.278 286.278.0 01-39.307 2.716h-.1a286.366 286.366.0 01-39.237-2.718 330.245 330.245.0 01-13.88 46.455 334.129 334.129.0 0053.1 4.263h.115a333.931 333.931.0 0053.187-4.261 329.92 329.92.0 0047.174-11.208z" fill="#1b1c1d"/><path id="Primary" d="M211.993 256l22-38.1h44l22 38.1-22 38.105h-44zM342.134 106.813A274.957 274.957.0 01335.733 48h-48a322.932 322.932.0 007.587 69.4 282.293 282.293.0 0046.814-10.587zM428.269 256A282.438 282.438.0 01395.7 220.752a285.92 285.92.0 01-39.323-68.105A329.92 329.92.0 01309.2 163.854 334.125 334.125.0 00362.4 256a330.2 330.2.0 0033.3 35.248 322.971 322.971.0 0056.3 41.27l24-41.569A274.908 274.908.0 01428.269 256zM149.6 256a333.961 333.961.0 0030.34-44.03 334.156 334.156.0 0022.86-48.118 330.245 330.245.0 0013.88-46.455A322.893 322.893.0 00224.267 48h-48a274.9 274.9.0 01-6.4 58.811 282.241 282.241.0 01-14.238 45.834 286.3 286.3.0 01-17.264 35.339 286.331 286.331.0 01-22.054 32.768A330 330 0 01149.6 256zm-65.867.0A274.964 274.964.0 0136 290.949l24 41.569a322.915 322.915.0 0056.309-41.27A282.3 282.3.0 0083.733 256zM255.9 343.885a334.129 334.129.0 00-53.1 4.263 330.144 330.144.0 00-47.171 11.207 322.934 322.934.0 00-63.894 28.127l24 41.569a274.966 274.966.0 0154.132-23.862A282.46 282.46.0 01216.678 394.6a286.366 286.366.0 0139.237-2.718h.1A286.278 286.278.0 01295.32 394.6a329.953 329.953.0 0113.88-46.456 334.028 334.028.0 00-53.187-4.26zm86.236 61.3a275.027 275.027.0 0154.133 23.864l24-41.569a322.991 322.991.0 00-63.895-28.13 282.32 282.32.0 00-14.24 45.837z" fill="#33de72"/></g></svg></span><span class=font-weight-bold>Clusterpedia.io</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/about/><span>About</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/blog/><i class="fas fa-blog"></i><span class=active>Blog</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/docs/><i class="fas fa-book"></i><span>Documentation</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=https://github.com/clusterpedia-io/clusterpedia target=_blank><i class="fab fa-github"></i><span>GitHub</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=https://cloud-native.slack.com/messages/clusterpedia target=_blank><i class="fab fa-slack"></i><span>Slack</span></a>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
English
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/zh-cn/blog/>中文 Chinese</a>
</div>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.78403f3e446f31afd214946fb52aeb24.json data-offline-search-base-href=/ data-offline-search-max-results=10>
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
</div>
<div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
</div>
<main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role=main>
<div class=td-content>
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.
</p><p>
<a href=/blog/>Return to the regular view of this page</a>.
</p>
</div>
<h1 class=title>Blog</h1>
<ul>
<li><a href=#pg-cc054d8ee6a886e6b372f1c6e1e3f4c7>Cluster API Searching Has Never Been Easier</a></li>
<li><a href=#pg-7577e1f00c898d6b5b357ef97fca540f>Clusterpedia is Listed in the CNCF Cloud Native Landscape</a></li>
<li><a href=#pg-570d9cd46f5853e421c710b83718495c>Clusterpedia v0.2.0 Release</a></li>
<li><a href=#pg-5c2e1f7ae120a013634369fe0b07ac44>Quickly Deploy Clusterpedia with Helm</a></li>
<li><a href=#pg-a573450d521123dfff28da4e584abd0a>Clusterpedia Awarded | One of IT Technology Influcence Stars Selected by CSDN</a></li>
<li><a href=#pg-a515773982ea192aad88251c576747f1>Demo Video ｜Clusterpedia - Complex Retrieval of Resources in a Multi-Cloud Environment</a></li>
<li><a href=#pg-67dca6481b949a69612c7865dea88885>Clusterpedia v0.1.0 Release — four important functions</a></li>
<li><a href=#pg-a32dbb6812755843c6db353189298112>Upgrade to Clusterpedia 0.1.0</a></li>
<li><a href=#pg-5a9086c52772fbac4aea92a7ce0b36db>Clusterpedia with kubectl support to retrieve multicluster resources</a></li>
</ul>
<div class=content>
</div>
</div>
<div class=td-content>
<h1 id=pg-cc054d8ee6a886e6b372f1c6e1e3f4c7>Cluster API Searching Has Never Been Easier</h1>
<div class="td-byline mb-4">
<time datetime=2022-08-04 class=text-muted>Thursday, August 04, 2022</time>
</div>
<p>After 0.4.0, Clusterpedia provides a more friendly way to interface to multi-cloud platforms,
Users simply create or join clusters in the multi-cloud platform and then use Clusterpedia to retrieve the resources within those clusters directly .</p>
<blockquote>
<p>We maintain <code>ClusterImportPolicy</code> for each multi-cloud platform in the <a href=https://github.com/clusterpedia-io/clusterpedia/tree/main/deploy/clusterimportpolicy>Clusterpedia repository</a>. You are very welcome to submit ClusterImportPolicy to Clusterpedia for interfacing to other multi-cloud platforms.</p>
<p>After installing Clusterpedia, you can create the appropriate ClusterImportPolicy, or you can <a href=https://clusterpedia.io/docs/usage/interfacing-to-multi-cloud-platforms/#new-clusterimportpolicy>create a new ClusterImportPolicy</a> according to your needs (multi-cloud platform).</p>
</blockquote>
<p>The ClusterImportPolicy for the Cluster API has been submitted in <a href=https://github.com/clusterpedia-io/clusterpedia/pull/288>clusterpedia#288</a>.
After creating clusters in the Cluster API, you can use Clusterpedia directly to do complex searches of resources within these clusters.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kubectl get cluster
NAME                PHASE         AGE    VERSION
capi-quickstart     Provisioned   10m    v1.24.2
capi-quickstart-2   Provisioned   118s   v1.24.2

$ kubectl get kubeadmcontrolplane
NAME                      CLUSTER             INITIALIZED   API SERVER AVAILABLE   REPLICAS   READY   UPDATED   UNAVAILABLE   AGE   VERSION
capi-quickstart-2-ctm9k   capi-quickstart-2   <span style=color:#204a87>true</span>                                 <span style=color:#0000cf;font-weight:700>1</span>                  <span style=color:#0000cf;font-weight:700>1</span>         <span style=color:#0000cf;font-weight:700>1</span>             10m   v1.24.2
capi-quickstart-2xcsz     capi-quickstart     <span style=color:#204a87>true</span>                                 <span style=color:#0000cf;font-weight:700>1</span>                  <span style=color:#0000cf;font-weight:700>1</span>         <span style=color:#0000cf;font-weight:700>1</span>             19m   v1.24.2

$ <span style=color:#8f5902;font-style:italic># the pediacluster resources will automatically create, updates or delete based on cluster resources</span>
$ kubectl get pediacluster -o wide
NAME                        READY   VERSION   APISERVER   VALIDATED   SYNCHRORUNNING   CLUSTERHEALTHY
default-capi-quickstart     True    v1.24.2               Validated   Running          Healthy
default-capi-quickstart-2   True    v1.24.2               Validated   Running          Healthy

$ kubectl --cluster clusterpedia get no
CLUSTER                     NAME                                            STATUS     ROLES           AGE   VERSION
default-capi-quickstart-2   capi-quickstart-2-ctm9k-g2m87                   NotReady   control-plane   12m   v1.24.2
default-capi-quickstart-2   capi-quickstart-2-md-0-s8hbx-7bd44554b5-kzcb6   NotReady   &lt;none&gt;          11m   v1.24.2
default-capi-quickstart     capi-quickstart-2xcsz-fxrrk                     NotReady   control-plane   21m   v1.24.2
default-capi-quickstart     capi-quickstart-md-0-9tw2g-b8b4f46cf-gggvq      NotReady   &lt;none&gt;          20m   v1.24.2
</code></pre></div><h2 id=quickly-deploy-a-sample-environment-for-cluster-api-and-clusterpedia>Quickly deploy a sample environment for Cluster API and Clusterpedia</h2>
<h3 id=prerequisites>Prerequisites</h3>
<ul>
<li>Install and setup <a href=https://kubernetes.io/docs/tasks/tools/install-kubectl/>kubectl</a> in your local environment</li>
<li>Install <a href=https://kind.sigs.k8s.io/>Kind</a> and <a href=https://www.docker.com/>Docker</a></li>
<li>Install <a href=https://cluster-api.sigs.k8s.io/user/quick-start.html#install-clusterctl>clusterctl</a></li>
</ul>
<blockquote>
<p>Minimum kind supported version: v0.14.0</p>
</blockquote>
<h3 id=create-a-management-cluster-and-deploy-the-cluster-api>Create a management cluster and deploy the Cluster API</h3>
<blockquote>
<p>Deploying the Cluster API can also be found in <a href=https://cluster-api.sigs.k8s.io/user/quick-start.html>https://cluster-api.sigs.k8s.io/user/quick-start.html</a></p>
</blockquote>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ cat &gt; kind-cluster-with-extramounts.yaml <span style=color:#4e9a06>&lt;&lt;EOF
</span><span style=color:#4e9a06>kind: Cluster
</span><span style=color:#4e9a06>apiVersion: kind.x-k8s.io/v1alpha4
</span><span style=color:#4e9a06>nodes:
</span><span style=color:#4e9a06>- role: control-plane
</span><span style=color:#4e9a06>  extraMounts:
</span><span style=color:#4e9a06>    - hostPath: /var/run/docker.sock
</span><span style=color:#4e9a06>      containerPath: /var/run/docker.sock
</span><span style=color:#4e9a06>EOF</span>

$ kind create cluster --name capi-sample --config kind-cluster-with-extramounts.yaml

$ <span style=color:#204a87>export</span> <span style=color:#000>CLUSTER_TOPOLOGY</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
$ clusterctl init --infrastructure docker
</code></pre></div><h3 id=deploy-clusterpedia>Deploy Clusterpedia</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ git clone https://github.com/clusterpedia-io/clusterpedia.git <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#204a87>cd</span> clusterpedia/charts
$ helm install clusterpedia . <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>  --namespace clusterpedia-system <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>  --create-namespace <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>  --set <span style=color:#000>installCRDs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>  <span style=color:#8f5902;font-style:italic># --set persistenceMatchNode={{ LOCAL_PV_NODE }}</span>
  --set <span style=color:#000>persistenceMatchNode</span><span style=color:#ce5c00;font-weight:700>=</span>capi-sample-control-plane
</code></pre></div><blockquote>
<p>The Clusterpedia Chart creates a local pv for the storage component, but you need to specify the node using the persistenceMatchNode option, eg. &ndash;set persistenceMatchNode=master-1.</p>
<p>If you don&rsquo;t need to create a local pv, add the &ndash;set persistenceMatchNode=None flag.
<a href=https://github.com/clusterpedia-io/clusterpedia/tree/main/charts>Lean More</a></p>
</blockquote>
<p>Create <a href=https://clusterpedia.io/docs/concepts/cluster-import-policy/>ClusterImportPolicy</a> for interfacing to the Cluster API</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kubectl apply -f https://raw.githubusercontent.com/Iceber/clusterpedia/add_cluster_api_clusterimportpolicy/deploy/clusterimportpolicy/cluster_api.yaml
</code></pre></div><blockquote>
<p>Clusterpedia can be integrated into any multi-cloud management platform, <a href=https://clusterpedia.io/docs/usage/interfacing-to-multi-cloud-platforms/>Lean More</a></p>
</blockquote>
<p><a href=https://clusterpedia.io/docs/usage/access-clusterpedia/#configure-the-cluster-shortcut-for-kubectl>Gen cluster shortcut for kubectl</a>, If you use client-go or OpenAPI to access, you can omit this step</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ curl -sfL https://raw.githubusercontent.com/clusterpedia-io/clusterpedia/main/hack/gen-clusterconfigs.sh <span style=color:#000;font-weight:700>|</span> sh -

$ <span style=color:#8f5902;font-style:italic># Using kubectl to retrieve multicluster resources, the current Cluster API does not create a cluster, so it returns null</span>
$ kubectl --cluster clusterpedia api-resources
</code></pre></div><h2 id=create-a-cluster-using-the-cluster-api>Create a cluster using the Cluster API</h2>
<blockquote>
<p>When using the sample environments' Docker Provider to create a cluster, you need to add <code>--flavor development</code> flag.</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ clusterctl generate cluster capi-quickstart --flavor development <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>  --kubernetes-version v1.24.2 <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>  --control-plane-machine-count<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>  --worker-machine-count<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>  &gt; capi-quickstart.yaml
$ kubectl apply -f ./capi-quickstart.yaml
</code></pre></div><h3 id=view-cluster-creation-status>View cluster creation status</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kubectl get cluster
NAME              PHASE         AGE   VERSION
capi-quickstart   Provisioned   8s    v1.24.2

$ kubectl get kubeadmcontrolplane -w
NAME                    CLUSTER           INITIALIZED   API SERVER AVAILABLE   REPLICAS   READY   UPDATED   UNAVAILABLE   AGE   VERSION
capi-quickstart-2xcsz   capi-quickstart   <span style=color:#204a87>true</span>                                 <span style=color:#0000cf;font-weight:700>1</span>                  <span style=color:#0000cf;font-weight:700>1</span>         <span style=color:#0000cf;font-weight:700>1</span>             86s   v1.24.2
</code></pre></div><p><strong>when kubeadmcontrolplane&rsquo;s Initialized is true</strong>, lusterpedia will automatically synchronize the resources in the cluster, you can use <code>kubectl --cluster clusterpedia get</code> to search the resources.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kubectl get pediacluster
NAME                      READY   VERSION   APISERVER
default-capi-quickstart   True    v1.24.2

$ kubectl --cluster clusterpedia get pod -A
NAMESPACE     CLUSTER                   NAME                                                  READY   STATUS    RESTARTS   AGE
kube-system   default-capi-quickstart   kube-apiserver-capi-quickstart-2xcsz-fxrrk            1/1     Running   <span style=color:#0000cf;font-weight:700>0</span>          2m32s
kube-system   default-capi-quickstart   kube-scheduler-capi-quickstart-2xcsz-fxrrk            1/1     Running   <span style=color:#0000cf;font-weight:700>0</span>          2m31s
kube-system   default-capi-quickstart   coredns-6d4b75cb6d-lrwj4                              0/1     Pending   <span style=color:#0000cf;font-weight:700>0</span>          2m20s
kube-system   default-capi-quickstart   kube-proxy-p8v9m                                      1/1     Running   <span style=color:#0000cf;font-weight:700>0</span>          2m20s
kube-system   default-capi-quickstart   kube-controller-manager-capi-quickstart-2xcsz-fxrrk   1/1     Running   <span style=color:#0000cf;font-weight:700>0</span>          2m32s
kube-system   default-capi-quickstart   etcd-capi-quickstart-2xcsz-fxrrk                      1/1     Running   <span style=color:#0000cf;font-weight:700>0</span>          2m32s
kube-system   default-capi-quickstart   kube-proxy-2ln2w                                      1/1     Running   <span style=color:#0000cf;font-weight:700>0</span>          105s
kube-system   default-capi-quickstart   coredns-6d4b75cb6d-2hcmz                              0/1     Pending   <span style=color:#0000cf;font-weight:700>0</span>          2m20s
</code></pre></div><p>The <a href=https://github.com/clusterpedia-io/clusterpedia/pull/288/files>cluster-api clusterimportpolicy</a> sets the resources to be synchronized by default in the cluster.</p>
<p>Users can also manually modify the configuration of synchronization in pediacluster, <a href=https://clusterpedia.io/docs/usage/sync-resources/>Synchronize Cluster Resources</a></p>
<p>When the cluster is deleted in the Cluster API, Clusterpedia also deletes <a href=https://clusterpedia.io/docs/concepts/pediacluster/>PeidaCluster</a> at the same time.</p>
<h2 id=resources-retrieval-for-multiple-clusters>Resources retrieval for multiple clusters</h2>
<p>Use the above steps to create multiple clusters</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kubectl get cluster
NAME                PHASE         AGE    VERSION
capi-quickstart     Provisioned   10m    v1.24.2
capi-quickstart-2   Provisioned   118s   v1.24.2

$ kubectl get kubeadmcontrolplane
NAME                      CLUSTER             INITIALIZED   API SERVER AVAILABLE   REPLICAS   READY   UPDATED   UNAVAILABLE   AGE   VERSION
capi-quickstart-2-ctm9k   capi-quickstart-2   <span style=color:#204a87>true</span>                                 <span style=color:#0000cf;font-weight:700>1</span>                  <span style=color:#0000cf;font-weight:700>1</span>         <span style=color:#0000cf;font-weight:700>1</span>             10m   v1.24.2
capi-quickstart-2xcsz     capi-quickstart     <span style=color:#204a87>true</span>                                 <span style=color:#0000cf;font-weight:700>1</span>                  <span style=color:#0000cf;font-weight:700>1</span>         <span style=color:#0000cf;font-weight:700>1</span>             19m   v1.24.2

$ <span style=color:#8f5902;font-style:italic># the pediacluster resources will automatically create, updates or delete based on cluster resources</span>
$ kubectl get pediacluster -o wide
NAME                        READY   VERSION   APISERVER   VALIDATED   SYNCHRORUNNING   CLUSTERHEALTHY
default-capi-quickstart     True    v1.24.2               Validated   Running          Healthy
default-capi-quickstart-2   True    v1.24.2               Validated   Running          Healthy

$ kubectl --cluster clusterpedia get no
CLUSTER                     NAME                                            STATUS     ROLES           AGE   VERSION
default-capi-quickstart-2   capi-quickstart-2-ctm9k-g2m87                   NotReady   control-plane   12m   v1.24.2
default-capi-quickstart-2   capi-quickstart-2-md-0-s8hbx-7bd44554b5-kzcb6   NotReady   &lt;none&gt;          11m   v1.24.2
default-capi-quickstart     capi-quickstart-2xcsz-fxrrk                     NotReady   control-plane   21m   v1.24.2
default-capi-quickstart     capi-quickstart-md-0-9tw2g-b8b4f46cf-gggvq      NotReady   &lt;none&gt;          20m   v1.24.2
</code></pre></div><p>Clusterpedia supports two types of resource search:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kubectl api-resources <span style=color:#000;font-weight:700>|</span> grep clusterpedia.io
collectionresources     clusterpedia.io/v1beta1  <span style=color:#204a87>false</span>   CollectionResource
resources               clusterpedia.io/v1beta1  <span style=color:#204a87>false</span>   Resources
</code></pre></div><ul>
<li><a href=https://clusterpedia.io/docs/usage/access-clusterpedia/#access-the-clusterpedia-resources>Resources that are compatible with Kubernetes OpenAPI</a></li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kubectl --cluster clusterpedia get cm -A
NAMESPACE         CLUSTER                     NAME                                 DATA   AGE
kube-system       default-capi-quickstart     extension-apiserver-authentication   <span style=color:#0000cf;font-weight:700>6</span>      19m
kube-system       default-capi-quickstart     kubeadm-config                       <span style=color:#0000cf;font-weight:700>1</span>      19m
kube-public       default-capi-quickstart     cluster-info                         <span style=color:#0000cf;font-weight:700>2</span>      19m
kube-system       default-capi-quickstart     kube-proxy                           <span style=color:#0000cf;font-weight:700>2</span>      19m
kube-node-lease   default-capi-quickstart     kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      19m
kube-system       default-capi-quickstart-2   extension-apiserver-authentication   <span style=color:#0000cf;font-weight:700>6</span>      10m
kube-system       default-capi-quickstart     kubelet-config                       <span style=color:#0000cf;font-weight:700>1</span>      19m
kube-system       default-capi-quickstart     coredns                              <span style=color:#0000cf;font-weight:700>1</span>      19m
kube-system       default-capi-quickstart     kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      19m
kube-public       default-capi-quickstart     kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      19m
kube-system       default-capi-quickstart-2   coredns                              <span style=color:#0000cf;font-weight:700>1</span>      10m
default           default-capi-quickstart     kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      19m
kube-system       default-capi-quickstart-2   kube-proxy                           <span style=color:#0000cf;font-weight:700>2</span>      10m
kube-system       default-capi-quickstart-2   kubeadm-config                       <span style=color:#0000cf;font-weight:700>1</span>      10m
kube-system       default-capi-quickstart-2   kubelet-config                       <span style=color:#0000cf;font-weight:700>1</span>      10m
kube-system       default-capi-quickstart-2   kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      10m
kube-node-lease   default-capi-quickstart-2   kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      10m
kube-public       default-capi-quickstart-2   cluster-info                         <span style=color:#0000cf;font-weight:700>3</span>      10m
kube-public       default-capi-quickstart-2   kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      10m
default           default-capi-quickstart-2   kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      10m

$ <span style=color:#8f5902;font-style:italic># gen cluster shortcuts</span>
$ curl -sfL https://raw.githubusercontent.com/clusterpedia-io/clusterpedia/main/hack/gen-clusterconfigs.sh <span style=color:#000;font-weight:700>|</span> sh -
$ kubectl --cluster default-capi-quickstart get cm -n kube-system
</code></pre></div><ul>
<li><a href=https://clusterpedia.io/docs/concepts/collection-resource/>Collection Resource</a></li>
</ul>
<p>Clusterpedia can also perform more advanced aggregation of resources. For example, you can use Collection Resource to get a set of different resources at once.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kubectl get collectionresources
NAME            RESOURCES
any             *
workloads       apps.deployments,apps.daemonsets,apps.statefulsets
kuberesources   .*,admission.k8s.io.*,admissionregistration.k8s.io.*,apiextensions.k8s.io.*,apps.*,authentication.k8s.io.*,authorization.k8s.io.*,autoscaling.*,batch.*,certificates.k8s.io.*,coordination.k8s.io.*,discovery.k8s.io.*,events.k8s.io.*,extensions.*,flowcontrol.apiserver.k8s.io.*,imagepolicy.k8s.io.*,internal.apiserver.k8s.io.*,networking.k8s.io.*,node.k8s.io.*,policy.*,rbac.authorization.k8s.io.*,scheduling.k8s.io.*,storage.k8s.io.*

$ kubectl get collectionresources workloads
</code></pre></div><h3 id=searchhttpsgithubcomclusterpedia-ioclusterpediasearch-label-and-url-query><a href=https://github.com/clusterpedia-io/clusterpedia#search-label-and-url-query>Search</a></h3>
<ul>
<li><a href=https://clusterpedia.io/docs/usage/search/#search-by-metadata>Search by metadata(clusters, namespaces, resource names, creation time interval</a></li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kubectl --cluster clusterpedia get cm -A -l <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    <span style=color:#4e9a06>&#34;search.clusterpedia.io/clusters in (default-capi-quickstart,default-capi-quickstart-2),\
</span><span style=color:#4e9a06>    search.clusterpedia.io/namespaces in (kube-system,default)&#34;</span>
NAMESPACE     CLUSTER                     NAME                                 DATA   AGE
kube-system   default-capi-quickstart     extension-apiserver-authentication   <span style=color:#0000cf;font-weight:700>6</span>      23m
kube-system   default-capi-quickstart     kubeadm-config                       <span style=color:#0000cf;font-weight:700>1</span>      23m
kube-system   default-capi-quickstart     kube-proxy                           <span style=color:#0000cf;font-weight:700>2</span>      23m
kube-system   default-capi-quickstart-2   extension-apiserver-authentication   <span style=color:#0000cf;font-weight:700>6</span>      14m
kube-system   default-capi-quickstart     kubelet-config                       <span style=color:#0000cf;font-weight:700>1</span>      23m
kube-system   default-capi-quickstart     coredns                              <span style=color:#0000cf;font-weight:700>1</span>      23m
kube-system   default-capi-quickstart     kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      23m
kube-system   default-capi-quickstart-2   coredns                              <span style=color:#0000cf;font-weight:700>1</span>      14m
default       default-capi-quickstart     kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      23m
kube-system   default-capi-quickstart-2   kube-proxy                           <span style=color:#0000cf;font-weight:700>2</span>      14m
kube-system   default-capi-quickstart-2   kubeadm-config                       <span style=color:#0000cf;font-weight:700>1</span>      14m
kube-system   default-capi-quickstart-2   kubelet-config                       <span style=color:#0000cf;font-weight:700>1</span>      14m
kube-system   default-capi-quickstart-2   kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      14m
default       default-capi-quickstart-2   kube-root-ca.crt                     <span style=color:#0000cf;font-weight:700>1</span>      14m
</code></pre></div><ul>
<li><a href=https://clusterpedia.io/docs/usage/search/multi-cluster/#fuzzy-search>Fuzzy Search</a></li>
<li><a href=https://clusterpedia.io/docs/usage/search/multi-cluster/#field-selector>Enhanced Field Selector</a></li>
<li><a href=https://clusterpedia.io/docs/usage/search/multi-cluster/#search-by-parent-or-ancestor-owner>Search by Parent or Ancestor Owner</a></li>
<li><a href=https://clusterpedia.io/docs/usage/search/multi-cluster/#paging-and-sorting>Paging and Sorting</a></li>
<li><a href=https://clusterpedia.io/docs/usage/search/#advanced-searchcustom-conditional-search>Advanced Search</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-7577e1f00c898d6b5b357ef97fca540f>Clusterpedia is Listed in the CNCF Cloud Native Landscape</h1>
<div class="td-byline mb-4">
<time datetime=2022-04-29 class=text-muted>Friday, April 29, 2022</time>
</div>
<p>In the updated CNCF Cloud Native Landscape, Clusterpedia was listed into the Scheduling & Orchestration quadrant of the Orchestration & Management layer, becoming a cloud-native multi-cluster complex retrieval tool recommended by CNCF.</p>
<p><a href="https://landscape.cncf.io/card-mode?category=scheduling-orchestration&grouping=category&selected=clusterpedia"><img class="aligncenter wp-image-7957 size-full" src=https://p26.toutiaoimg.com/origin/tos-cn-i-qvj2lq49k0/3871965400044875af28b263a790504c alt width=800 height=500 data-tag=bdshare></a></p>
<hr>
<p>Cloud Native Computing Foundation (CNCF) belongs to the Linux Foundation and was established in December 2015. It is a non-profit organization dedicated to fostering and maintaining a vendor-neutral open source ecosystem to promote cloud native technologies and make cloud native universal and sustainable.</p>
<p>The Cloud Native Landscape has been maintained by CNCF since December 2016. It is intended as a map to list popular projects with best practices in the community, and categorizes them in the cloud native space to provide reference for enterprises to build a cloud native ecosystem. It has extensive influence on the development, operation, and maintenance of cloud native technologies.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-570d9cd46f5853e421c710b83718495c>Clusterpedia v0.2.0 Release</h1>
<div class="td-byline mb-4">
<time datetime=2022-04-12 class=text-muted>Tuesday, April 12, 2022</time>
</div>
<h2 id=use-helm-to-install>Use helm to install</h2>
<p>Users can already use Helm to install Clusterpedia:</p>
<pre><code>$ helm install clusterpedia . \
  --namespace clusterpedia-system \
  --create-namespace \
  --set persistenceMatchNode={{ LOCAL_PV_NODE }} \
  # --set installCRDs=true
</code></pre>
<p><a href=https://github.com/clusterpedia-io/clusterpedia/tree/main/charts>Lean More</a></p>
<h2 id=use-the-kube-config-to-import-a-cluster>Use the Kube Config to import a cluster</h2>
<p>For v0.1.0, users need to Configure the address for the imported cluster and the authentication information.</p>
<pre><code>apiVersion: cluster.clusterpedia.io/v1alpha2
kind: PediaCluster
metadata:
  name: cluster-example
spec:
  apiserver: &quot;https://10.30.43.43:6443&quot;
  caData:
  tokenData:
  certData:
  keyData:
  syncResources: []
</code></pre>
<p>In v0.2.0, the <code>PediaCluster</code> added the <code>spec.kubeconfig</code> field so that users can use <code>kube config</code> to import the cluster directly.</p>
<p>First you need to base64 encode the kube config for the imported cluster.</p>
<pre><code>$ base64 ./kubeconfig.yaml
</code></pre>
<p>Set the content after the base64 to PediaCluster <code>spec.kubeconfig</code>, in addition <code>spec.apiserver</code> and other authentication fields don’t need to set.</p>
<pre><code>apiVersion: cluster.clusterpedia.io/v1alpha2
kind: PediaCluster
metadata:
  name: cluster-example
spec:
  kubeconfig: **base64 kubeconfig**
  syncResources: []
</code></pre>
<p>However, since the cluster address is configured in kube config, the <strong>APIServer</strong> is empty when you use kubectl get pediacluster.</p>
<pre><code>$ kubectl get pediacluster
NAME              APISERVER   VERSION   STATUS
cluster-example               v1.22.2   Healthy
</code></pre>
<p>Mutating addmission webhooks will be added in the future to automatically set <code>spec.apiserver</code>, currently if you want to show the cluster apiserver address when <code>kubectl get pediacluster</code>, then you need to manually configure the <code>spec.apiserver</code> field additionally.</p>
<h2 id=new-search-feature>New Search Feature</h2>
<h3 id=search-by-creation-time-interval>Search by creation time interval</h3>
<table>
<thead>
<tr>
<th style=text-align:left>Description</th>
<th style=text-align:left>Search Label Key</th>
<th style=text-align:left>URL Query</th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:left>Since</td>
<td style=text-align:left>search.clusterpedia.io/since</td>
<td style=text-align:left>since</td>
</tr>
<tr>
<td style=text-align:left>Before</td>
<td style=text-align:left>search.clusterpedia.io/before</td>
<td style=text-align:left>before</td>
</tr>
</tbody>
</table>
<p>The creation time interval used for the search is left closed and right open, <strong>since &lt;= creation time &lt; before</strong>.</p>
<p>There are four formats for creation time:</p>
<ol>
<li><code>Unix Timestamp</code> for ease of use will distinguish between units of <code>s</code> or <code>ms</code> based on the length of the timestamp. The 10-bit timestamp is in seconds, the 13-bit timestamp is in milliseconds.</li>
<li><code>RFC3339</code> <em>2006-01-02T15:04:05Z</em> or <em>2006-01-02T15:04:05+08:00</em></li>
<li><code>UTC Date</code> <em>2006-01-02</em></li>
<li><code>UTC Datetime</code> <em>2006-01-02 15:04:05</em></li>
</ol>
<blockquote>
<p>Because of the limitation of the kube label selector, the search label only supports <code>Unix Timestamp</code> and <code>UTC Date</code>.</p>
<p>All formats are available using the url query method.</p>
</blockquote>
<p>Look at what resources are under the default namespace</p>
<pre><code>$ kubectl --cluster clusterpedia get pods
CLUSTER           NAME                                                 READY   STATUS      RESTARTS       AGE
cluster-example   quickstart-ingress-nginx-admission-create--1-kxlnn   0/1     Completed   0              171d
cluster-example   fake-pod-698dfbbd5b-wvtvw                            1/1     Running     0              8d
cluster-example   fake-pod-698dfbbd5b-74cjx                            1/1     Running     0              21d
cluster-example   fake-pod-698dfbbd5b-tmcw7                            1/1     Running     0              8d
</code></pre>
<p>We use the creation time to filter the resources.</p>
<pre><code>$ kubectl --cluster clusterpedia get pods -l &quot;search.clusterpedia.io/since=2022-03-20&quot;
CLUSTER           NAME                        READY   STATUS    RESTARTS   AGE
cluster-example   fake-pod-698dfbbd5b-wvtvw   1/1     Running   0          8d
cluster-example   fake-pod-698dfbbd5b-tmcw7   1/1     Running   0          8d


$ kubectl --cluster clusterpedia get pods -l &quot;search.clusterpedia.io/before=2022-03-20&quot;
CLUSTER           NAME                                                 READY   STATUS      RESTARTS       AGE
cluster-example   quickstart-ingress-nginx-admission-create--1-kxlnn   0/1     Completed   0              171d
cluster-example   fake-pod-698dfbbd5b-74cjx                            1/1     Running     0              21d
</code></pre>
<h3 id=search-by-owner-name>Search by Owner Name</h3>
<p>As of v0.1.0, we can specify ancestor or parent <code>Owner UID</code> to query resources, but <code>Owner UID</code> is not convenient to use, after all, you still need to know the UID of the Owner resource in advance.</p>
<p>In v0.2.0, we support querying directly with <code>Owner Name</code>, and the Owner query has been moved from experimental to released functionality, the prefix of <strong>Search Label</strong> has been upgraded from <em>internalstorage.c lusterpedia.io</em> to *search.clusterpedia.io *, and URL Query is provided.</p>
<table>
<thead>
<tr>
<th style=text-align:left>Role</th>
<th style=text-align:left>search label key</th>
<th style=text-align:left>url query</th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:left>Specified Owner UID</td>
<td style=text-align:left>search.clusterpedia.io/owner-uid</td>
<td style=text-align:left>ownerUID</td>
</tr>
<tr>
<td style=text-align:left>Specified Owner Name</td>
<td style=text-align:left>search.clusterpedia.io/owner-name</td>
<td style=text-align:left>ownerName</td>
</tr>
<tr>
<td style=text-align:left>SPecified Owner Group Resource</td>
<td style=text-align:left>search.clusterpedia.io/owner-gr</td>
<td style=text-align:left>ownerGR</td>
</tr>
<tr>
<td style=text-align:left>Specified Owner Seniority</td>
<td style=text-align:left><code>internalstorage.clusterpedia.io/owner-seniority</code></td>
<td style=text-align:left><code>ownerSeniority</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note that when specifying <code>Owner UID</code>, <code>Owner Name</code> and <code>Owner Group Resource</code> will be ignored.</p>
</blockquote>
<pre><code>$ kubectl --cluster cluster-example get pods -l \
    &quot;search.clusterpedia.io/owner-name=fake-pod, \
     search.clusterpedia.io/owner-seniority=1&quot;
CLUSTER           NAME                        READY   STATUS    RESTARTS   AGE
cluster-example   fake-pod-698dfbbd5b-wvtvw   1/1     Running   0          8d
cluster-example   fake-pod-698dfbbd5b-74cjx   1/1     Running   0          21d
cluster-example   fake-pod-698dfbbd5b-tmcw7   1/1     Running   0          8d
</code></pre>
<p><strong>In addition, to avoid multiple types of owner resources in some cases, we can use the</strong> <code>Owner Group Resource</code> <strong>to restrict the type of owner.</strong></p>
<pre><code>$ kubectl --cluster cluster-example get pods -l \
    &quot;search.clusterpedia.io/owner-name=fake-pod,\
     search.clusterpedia.io/owner-gr=deployments.apps,\
     search.clusterpedia.io/owner-seniority=1&quot;
... some output
</code></pre>
<h3 id=fuzzy-search-base-on-resource-names>Fuzzy Search base on resource names</h3>
<p>Since fuzzy search needs to be discussed further, it is temporarily provided as an experimental feature.</p>
<p>Only the Search Label method is supported, URL Query isn’t supported. |Role| search label key|url query| | &ndash; | &mdash;&mdash;&mdash;&mdash;&mdash; | &mdash;&mdash;- | |Fuzzy Search for resource name|internalstorage.clusterpedia.io/fuzzy-name|-|</p>
<pre><code>$ kubectl --cluster clusterpedia get deployments -l &quot;internalstorage.clusterpedia.io/fuzzy-name=fake&quot;
CLUSTER           NAME       READY   UP-TO-DATE   AVAILABLE   AGE
cluster-example   fake-pod   3/3     3            3           113d
</code></pre>
<p>You can use the in operator to pass multiple fuzzy arguments, so that you can filter out resources that have all strings in their names.</p>
<h2 id=other-features>Other Features</h2>
<p>In v0.1.0, searching the resources allow the number of remaining resources to be returned so that the user can calculate the total number of resources.</p>
<p>This feature has been enhanced in v0.2.0. When offset is too large, <code>remainingItemCount</code> may be negative, ensuring that the total number of resources can always be calculated.</p>
<p><a href=https://clusterpedia.io/docs/usage/search/multi-cluster/#response-with-remaining-count>Lean More</a></p>
<h2 id=release-noteshttpsgithubcomclusterpedia-ioclusterpediareleases><a href=https://github.com/clusterpedia-io/clusterpedia/releases>Release Notes</a></h2>
<ul>
<li>Support of using Helm Charts for installation (<a href=https://github.com/clusterpedia-io/clusterpedia/pull/53>#53</a>, <a href=https://github.com/clusterpedia-io/clusterpedia/pull/125>#125</a>, @calvin0327, @wzshiming)</li>
<li><code>PediaCluster</code> supports for importing a cluster using the kubeconfig (<a href=https://github.com/clusterpedia-io/clusterpedia/pull/115>#115</a>, @wzshiming)</li>
</ul>
<h3 id=apiserver>APIServer</h3>
<ul>
<li>Support for filtering resources by a period of creation (<a href=https://github.com/clusterpedia-io/clusterpedia/pull/113>#113</a>, @cleverhu)</li>
<li>Support for searching for resources by an Owner name. Now, the feature of <code>Search by Owner</code> is officially released. (<a href=https://github.com/clusterpedia-io/clusterpedia/pull/91>#91</a>, @Iceber)</li>
</ul>
<h3 id=default-storage-layer>Default Storage Layer</h3>
<ul>
<li>Support for fuzzy search by a resource name (<a href=https://github.com/clusterpedia-io/clusterpedia/pull/117>#117</a>, @cleverhu)</li>
<li><code>RemainingItemCount</code> can be a negative number. We can still use <code>offset + len(items) + remainingItemCount</code> to calculate the total amount of resources if the <code>Offset</code> is too large. (<a href=https://github.com/clusterpedia-io/clusterpedia/pull/123>#123</a>, @cleverhu)</li>
</ul>
<h3 id=bug-fixes>Bug Fixes</h3>
<ul>
<li>Fixed unnecessary <code>json.Unmarshal</code> and improved performance when searching (<a href=https://github.com/clusterpedia-io/clusterpedia/pull/89>#89</a>, <a href=https://github.com/clusterpedia-io/clusterpedia/pull/92>#92</a>, @Iceber)</li>
</ul>
<h3 id=deprecation>Deprecation</h3>
<ul>
<li><code>Search by Owner</code> has been released as an official feature. <code>internalstorage.clusterpedia.io/owner-name</code> and <code>internalstorage.clusterpedia.io/owner-seniority</code> will be removed in the next release. (<a href=https://github.com/clusterpedia-io/clusterpedia/pull/91>#91</a>, @Iceber)</li>
</ul>
<h3 id=other>Other</h3>
<ul>
<li><code>golangci-lint</code> is used as a static checking tool (<a href=https://github.com/clusterpedia-io/clusterpedia/pull/86>#86</a>, <a href=https://github.com/clusterpedia-io/clusterpedia/pull/88>#88</a>, @Iceber)</li>
<li>Added CI Workloads such as static checking and unit testing for code <a href=https://github.com/clusterpedia-io/clusterpedia/pull/87>#87</a>, @Iceber)</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-5c2e1f7ae120a013634369fe0b07ac44>Quickly Deploy Clusterpedia with Helm</h1>
<div class="td-byline mb-4">
<time datetime=2022-04-11 class=text-muted>Monday, April 11, 2022</time>
</div>
<p>Currently Clusterpedia has supported a rapid deployment with Helm.</p>
<p>All of first, you need to check if helm v3 is installed in your current environment.</p>
<h2 id=preparation>Preparation</h2>
<p>Pull the Clusterpedia repository.</p>
<blockquote>
<p>Currently, the chart has not been uploaded to the public charts repository.</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git clone https://github.com/clusterpedia-io/clusterpedia.git
<span style=color:#204a87>cd</span> clusterpedia/charts
</code></pre></div>
<p>Since Clusterpedia uses <code>bitnami/postgresql</code> and <code>bitnami/mysql</code> as subcharts of storage components, it is necessary to add the bitnami repository and update the dependencies of the clusterpedia chart.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm repo add bitnami https://charts.bitnami.com/bitnami
helm dependency build
</code></pre></div>
<h3 id=choose-storage-components>Choose storage components</h3>
<p>The Clusterpedia chart provides two storage components such as <code>bitnami/postgresql</code> and <code>bitnami/mysql</code> to choose from as sub-charts.</p>
<p><code>postgresql</code> is the default storage component. IF you want to use MySQL, you can add <code>--set postgresql.enabled=false --set mysql.enabled=true</code> in the subsequent installation command.</p>
<p>For specific configuration about storage components, see <a href=https://github.com/bitnami/charts/tree/master/bitnami/postgresql>bitnami/postgresql</a> and <a href=https://github.com/bitnami/charts/tree/master/bitnami/mysql>bitnami/mysql</a>.</p>
<p><strong>You can also choose not to install any storage component, but use external components. For related settings, see charts/values.yaml</strong></p>
<h3 id=choose-a-installation-or-management-mode-for-crds>Choose a installation or management mode for CRDs</h3>
<p>Clusterpedia requires proper CRD resources to be created in the retrieval environment. You can choose to manually deploy CRDs by using YAML, or you can manage it with Helm.</p>
<h4 id=manage-manually>Manage manually</h4>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl apply -f ./_crds
</code></pre></div>
<h4 id=manage-with-helm>Manage with Helm</h4>
<p>Manually add <code>--set installCRDs=true</code> in the subsequent installation command.</p>
<h3 id=check-if-you-need-to-create-a-local-pv>Check if you need to create a local PV</h3>
<p>Through the Clusterpedia chart, you can create storage components to use a local PV.</p>
<p><strong>You need to specify the node where the local PV is located through <code>--set persistenceMatchNode=&lt;selected node name></code> during installation.</strong></p>
<p>If you need not to create the local PV, you can use <code>--set persistenceMatchNode=None</code> to declare it explicitly.</p>
<h2 id=install-clusterpedia>Install Clusterpedia</h2>
<p>After the above procedure is completed, you can run the following command to install Clusterpedia:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm install clusterpedia . <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>--namespace clusterpedia-system <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>--create-namespace <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>--set <span style=color:#000>persistenceMatchNode</span><span style=color:#ce5c00;font-weight:700>={{</span> LOCAL_PV_NODE <span style=color:#ce5c00;font-weight:700>}}</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>--set <span style=color:#000>installCRDs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</code></pre></div>
<h2 id=uninstall-clusterpedia>Uninstall Clusterpedia</h2>
<p>Before uninstallation, you shall manually clear all <code>PediaCluster</code> resources.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl get pediacluster
</code></pre></div>
<p>You can run the command to uninstall it after the <code>PediaCluster</code> resources are cleared.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm -n clusterpedia-system uninstall clusterpedia
</code></pre></div>
<p>If you use any CRD resource that is manually created, you also need to manually clear the CRDs.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl delete -f ./_crds
</code></pre></div>
<p><strong>Note that PVC and PV will not be deleted. You need to manually delete them.</strong></p>
<p>If you created a local PV, you need log in to the node and remove all remained data about the local PV.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#8f5902;font-style:italic># Log in to the node with Local PV</span>
rm -rf /var/local/clusterpedia/internalstorage/&lt;storage type&gt;
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-a573450d521123dfff28da4e584abd0a>Clusterpedia Awarded | One of IT Technology Influcence Stars Selected by CSDN</h1>
<div class="td-byline mb-4">
<time datetime=2022-04-01 class=text-muted>Friday, April 01, 2022</time>
</div>
<div align=center><img src=http://blog.daocloud.io/wp-content/uploads/d807bc86a68e6e3bd67c041e86e611e0.jpg style=width:900px></div>
<hr>
<p>On March 30, CSDN officially announced the selection list of IT technology influence stars, and Clusterpedia was selected as a &ldquo;Cloud Native Technology Product in 2021&rdquo;.</p>
<p>In the multi-cloud era, it is more and more complex and becomes a problem for resource management and retrieval in a multi-cluster environment.</p>
<p>In a single cluster, we usually use kubectl to view resources, directly access Kubernetes OpenAPI, or use client-go to retrieve resources in the code.</p>
<p>Now, in a multi-cluster environment, Clusterpedia provides compatibility with Kubernetes OpenAPI, so you can still perform complex retrieval or search for multi-cluster resources like a single cluster without pulling data from each cluster to the local for filtering.</p>
<div align=center><img src=https://p3.toutiaoimg.com/origin/tos-cn-i-qvj2lq49k0/ad3f106d991a45acbbdfe067425def26 style=width:300px></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-a515773982ea192aad88251c576747f1>Demo Video ｜Clusterpedia - Complex Retrieval of Resources in a Multi-Cloud Environment</h1>
<div class="td-byline mb-4">
<time datetime=2022-03-01 class=text-muted>Tuesday, March 01, 2022</time>
</div>
<p>Iceber, the sponsor of Clusterpedia and a cloud native senior engineer of Daocloud, introduced the functions provided by Clusterpedia about resource retrieval in detail. This video step-by-step demonstrated what issues can be solved by using Clusterepdia.</p>
<div align=center><a href=https://www.bilibili.com/video/BV1qi4y117Vq><img class="aligncenter wp-image-7957 size-full" src=http://blog.daocloud.io/wp-content/uploads/clusterpedia.png alt width=800 height=500 data-tag=bdshare></a></div>
<h2 id=clusterpedia-is-an-artifact-for-multi-cluster-resource-retrieval>Clusterpedia is an artifact for multi-cluster resource retrieval</h2>
<p>With the increase of services you provide and the continuous expansion of the cluster scale, a single Kubernetes cluster may no longer meet the needs of many enterprises. As the cloud-native technologies develop, a multi-cloud era is coming. It is more complex and difficult to manage and retrieve resources in multiple clusters.</p>
<p>As a result, many excellent open source projects have emerged in the community, such as cluster api for cluster lifecycle management, karmada and clusternet for multi-cloud application management. Clusterpedia is built on these cloud management platforms to provide you with complex search for multi-cluster resources.</p>
<p>In a single cluster, we often use kubectl to view resources, directly access Kubernetes OpenAPI, or use client-go to retrieve resources in the code.</p>
<p>Now, in a multi-cluster environment, Clusterpedia provides compatibility with Kubernetes OpenAPI, so you can still perform complex retrieval or search for multi-cluster resources like a single cluster without pulling data from each cluster to the local for filtering.</p>
<p>In addition, the capabilities of Clusterpedia are not only for searching and viewing. It also supports simple control of resources in the future, just like wiki that also supports to edit entries. Clusterpedia provides the following features now:</p>
<ul>
<li>Support for search with complex conditions, filters, sorting, and paging</li>
<li>Support for requesting attached resources when querying resources</li>
<li>Use a unified retrieval portal for master cluster and multi-cluster resources</li>
<li>Compatible with kubernetes OpenAPI, through which you can directly use kubectl for multi-cluster retrieval and need not any third-party plugins or tools</li>
<li>Compatible with collecting different versions of cluster resources and not constrained by the version of master cluster</li>
<li>High performance and low memory consumption in the process of resource collection</li>
<li>Automatically start and stop resource collection based on to the health status of clusters</li>
<li>Support for the pluggable storage layer that indicates you can use other storage components to customize the storage layer</li>
<li>High availability</li>
</ul>
<h2 id=whats-next>What&rsquo;s Next</h2>
<p>In addition to supporting complex retrieval of multiple clusters, Clusterpedia can provide more benefits, such as a unified portal to the master cluster and multi-cluster resources through an aggregated API, low memory usage and weak network optimization when synchronizing sub-cluster resources in real time. It can also provide a pluggable storage layer to decouple the dependencies of storage components.</p>
<p>In the next topic, we will introduce the specific design and implementation principles, and explain more benefits offered by Clusterpedia, so stay tuned.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-67dca6481b949a69612c7865dea88885>Clusterpedia v0.1.0 Release — four important functions</h1>
<div class="td-byline mb-4">
<time datetime=2022-02-16 class=text-muted>Wednesday, February 16, 2022</time>
</div>
<p><strong>This is the first release of</strong> <a href=https://clusterpedia.io><strong>Clusterpedia</strong></a> <strong>🥳🥳🥳, and it also means that it is officially in the iteration phase.</strong></p>
<p>Compared to the initial <a href=https://github.com/clusterpedia-io/clusterpedia/tree/v0.0.8>v0.0.8</a> and <a href=https://github.com/clusterpedia-io/clusterpedia/tree/v0.0.9-alpha>v0.0.9-alpha</a>, v0.1.0 add a lot of features and makes some incompatible updates.</p>
<blockquote>
<p>If upgrading from v0.0.9-alpha or v0.0.8, you can refer to <a href=/blog/2022/02/15/upgrade-to-clusterpedia-0.1.0/>Upgrade to Clusterpedia 0.1.0</a></p>
</blockquote>
<h1 id=features-preview>Features Preview</h1>
<table>
<thead>
<tr>
<th style=text-align:left>Role</th>
<th style=text-align:left>Search Label Key</th>
<th style=text-align:left>URL Query</th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:left>Filter cluster names</td>
<td style=text-align:left><code>search.clusterpedia.io/clusters</code></td>
<td style=text-align:left><code>clusters</code></td>
</tr>
<tr>
<td style=text-align:left>Filter namespaces</td>
<td style=text-align:left><code>search.clusterpedia.io/namespaces</code></td>
<td style=text-align:left><code>namespaces</code></td>
</tr>
<tr>
<td style=text-align:left>Filter resource names</td>
<td style=text-align:left><code>search.clusterpedia.io/names</code></td>
<td style=text-align:left><code>names</code></td>
</tr>
<tr>
<td style=text-align:left>Specified Owner UID</td>
<td style=text-align:left><code>internalstorage.clusterpedia.io/owner-uid</code></td>
<td style=text-align:left>-</td>
</tr>
<tr>
<td style=text-align:left>Specified Owner Seniority</td>
<td style=text-align:left><code>internalstorage.clusterpedia.io/owner-seniority</code></td>
<td style=text-align:left><code>ownerSeniority</code></td>
</tr>
<tr>
<td style=text-align:left>Order by fields</td>
<td style=text-align:left><code>search.clusterpedia.io/orderby</code></td>
<td style=text-align:left><code>orderby</code></td>
</tr>
<tr>
<td style=text-align:left>Set page size</td>
<td style=text-align:left><code>search.clusterpedia.io/size</code></td>
<td style=text-align:left><code>limit</code></td>
</tr>
<tr>
<td style=text-align:left>Set page offset</td>
<td style=text-align:left><code>search.clusterpedia.io/offset</code></td>
<td style=text-align:left><code>continue</code></td>
</tr>
<tr>
<td style=text-align:left>Response include Continue</td>
<td style=text-align:left><code>search.clusterpedia.io/with-continue</code></td>
<td style=text-align:left><code>withContinue</code></td>
</tr>
<tr>
<td style=text-align:left>Response include remaining count</td>
<td style=text-align:left><code>search.clusterpedia.io/with-remaining-count</code></td>
<td style=text-align:left><code>withRemainingCount</code></td>
</tr>
</tbody>
</table>
<p>Native <code>Label Selector</code> and enhanced <code>Field Selector</code> supported in addition to search label.</p>
<h1 id=important-features>Important Features</h1>
<p>Let&rsquo;s start with the more important features that have been added in 0.1.0</p>
<ul>
<li>The number of remaining items carried in response data</li>
<li>Added warnning when searching for resources in a <code>Not Ready</code> cluster</li>
<li>Enhancements to the native FieldSelector</li>
<li>Search by Parent or Ancestor Owner</li>
</ul>
<h2 id=warnning-alert-on-resource-search>Warnning alert on resource search</h2>
<p>When a cluster is not ready for some reason, resources are often not synchronised properly either.</p>
<p>Warnning alerts are used to alert users of cluster exceptions when searching for resources within the cluster, and the resources searched may not be accurate in real time.</p>
<pre><code>$ kubectl get pediacluster
NAME        APISERVER                   VERSION   STATUS
cluster-1   https://10.6.100.10:6443    v1.22.2   ClusterSynchroStop

$ kubectl --cluster cluster-1 get pods
Warning: cluster-1 is not ready and the resources obtained may be inaccurate, reason: ClusterSynchroStop
CLUSTER     NAME                                                 READY   STATUS      RESTARTS   AGE
cluster-1   fake-pod-698dfbbd5b-64fsx                            1/1     Running     0          68d
cluster-1   fake-pod-698dfbbd5b-9ftzh                            1/1     Running     0          39d
cluster-1   fake-pod-698dfbbd5b-rk74p                            1/1     Running     0          39d
cluster-1   quickstart-ingress-nginx-admission-create--1-kxlnn   0/1     Completed   0          126d
</code></pre>
<h2 id=field-selector>Field Selector</h2>
<p>Native Kubernetes currently only supports field filtering on <code>metadata.name</code> and <code>metadata.namespace</code>, and the operators only support =, !=, ==`, which is very limited.</p>
<p>Although some specific resources will support some special fields, the use is still rather limited</p>
<pre><code># kubernetes/pkg
$ grep AddFieldLabelConversionFunc . -r
./apis/core/v1/conversion.go:   err := scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;Pod&quot;),
./apis/core/v1/conversion.go:   err = scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;Node&quot;),
./apis/core/v1/conversion.go:   err = scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;ReplicationController&quot;),
./apis/core/v1/conversion.go:   return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;Event&quot;),
./apis/core/v1/conversion.go:   return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;Namespace&quot;),
./apis/core/v1/conversion.go:   return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;Secret&quot;),
./apis/certificates/v1/conversion.go:   return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;CertificateSigningRequest&quot;),
./apis/certificates/v1beta1/conversion.go:      return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;CertificateSigningRequest&quot;),
./apis/batch/v1/conversion.go:  return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;Job&quot;),
./apis/batch/v1beta1/conversion.go:             err = scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(kind),
./apis/events/v1/conversion.go: return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;Event&quot;),
./apis/events/v1beta1/conversion.go:    return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;Event&quot;),
./apis/apps/v1beta2/conversion.go:      if err := scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;StatefulSet&quot;),
./apis/apps/v1beta1/conversion.go:      if err := scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&quot;StatefulSet&quot;),
</code></pre>
<p>Clusterpedia provides more powerful features based on the compatibility with existing Field Selector features, and supports the same operators as Label Selector: <code>!</code>, <code>=</code>, <code>!=</code>, <code>==</code>, <code>in</code>, <code>notin</code>.</p>
<p>For example, we can filter by annotations, like label selector</p>
<pre><code>kubectl get deploy --field-selector=&quot;metadata.annotations['test.io'] in (value1, value2)&quot;
</code></pre>
<p><a href=https://clusterpedia.io/docs/usage/search/multi-cluster/#field-selector>Lean More</a></p>
<h2 id=search-by-parent-or-ancestor-owner>Search by Parent or Ancestor Owner</h2>
<p>There will usually be an Owner relationship between Kubernetes resources.</p>
<pre><code>apiVersion: v1
kind: Pod
metadata:
  ownerReferences:
  - apiVersion: apps/v1
    blockOwnerDeletion: true
    controller: true
    kind: ReplicaSet
    name: fake-pod-698dfbbd5b
    uid: d5bf2bdd-47d2-4932-84fb-98bde486d244
</code></pre>
<p>Searching by Owner is a very useful search function, and Clusterpedia also supports the seniority advancement of Owner to search for grandparents and even higher seniority.</p>
<p>By searching by Owner, we can query all Pods under Deployment at once, without having to query ReplicaSet in between</p>
<blockquote>
<p>Currently only supports query by Owner UID. The feature of using Owner Name for queries is still under discussion, we can join the discussion in the <a href=https://github.com/clusterpedia-io/clusterpedia/issues/49>issue: Support for searching resources by owner</a></p>
</blockquote>
<pre><code>$ DEPLOY_UID=$(kubectl --cluster cluster-1 get deploy fake-deploy -o jsonpath=&quot;{.metadata.uid}&quot;)
$ kubectl --cluster cluster-1 get pods -l \
    &quot;internalstorage.clusterpedia.io/owner-uid=$DEPLOY_UID,\
     internalstorage.clusterpedia.io/owner-seniority=1&quot;
</code></pre>
<p><a href=https://clusterpedia.io/docs/usage/search/multi-cluster/#search-by-parent-or-ancestor-owner>Lean More</a></p>
<h2 id=the-number-of-remaining-items-carried-in-response-data>The number of remaining items carried in response data</h2>
<p><strong>In some UI cases, it is often necessary to get the total number of resources in the current search condition.</strong></p>
<p>The RemainingItemCount field exists in the <a href=https://pkg.go.dev/k8s.io/apimachinery/pkg/apis/meta/v1#ListMeta>ListMeta</a> of the Kubernetes List response.</p>
<pre><code>type ListMeta struct {
    ...

        // remainingItemCount is the number of subsequent items in the list which are not included in this
        // list response. If the list request contained label or field selectors, then the number of
        // remaining items is unknown and the field will be left unset and omitted during serialization.
        // If the list is complete (either because it is not chunking or because this is the last chunk),
        // then there are no more remaining items and this field will be left unset and omitted during
        // serialization.
        // Servers older than v1.15 do not set this field.
        // The intended use of the remainingItemCount is *estimating* the size of a collection. Clients
        // should not rely on the remainingItemCount to be set or to be exact.
        // +optional
    RemainingItemCount *int64 `json:&quot;remainingItemCount,omitempty&quot; protobuf:&quot;bytes,4,opt,name=remainingItemCount&quot;`
}
</code></pre>
<p>By reusing this field, the total number of resources can be returned in a Kubernetes OpenAPI-compatible manner:</p>
<p><strong>offset + len(list.items) + list.metadata.remainingItemCount</strong></p>
<blockquote>
<p>Use with Paging</p>
</blockquote>
<pre><code>$ kubectl get --raw=&quot;/apis/clusterpedia.io/v1beta1/resources/apis/apps/v1/deployments?withRemainingCount&amp;limit=1&quot; | jq
{
  &quot;kind&quot;: &quot;DeploymentList&quot;,
  &quot;apiVersion&quot;: &quot;apps/v1&quot;,
  &quot;metadata&quot;: {
    &quot;remainingItemCount&quot;: 23
  },
  &quot;items&quot;: [
    ...
  ]
}
</code></pre>
<p><a href=https://clusterpedia.io/docs/usage/search/multi-cluster/#response-with-remaining-count>Lean More</a></p>
<h1 id=realease-v010httpsgithubcomclusterpedia-ioclusterpediareleasestagv010><a href=https://github.com/clusterpedia-io/clusterpedia/releases/tag/v0.1.0>Realease v0.1.0</a></h1>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-a32dbb6812755843c6db353189298112>Upgrade to Clusterpedia 0.1.0</h1>
<div class="td-byline mb-4">
<time datetime=2022-02-15 class=text-muted>Tuesday, February 15, 2022</time>
</div>
<p>With the release of Clusterpedia 0.1.0, we can now update the earlier 0.0.9-alpha or 0.0.8 to 0.1.0</p>
<h2 id=clean-resources>Clean Resources</h2>
<p>Since the url path to search resources has been modified(<a href=https://github.com/clusterpedia-io/clusterpedia/pull/73>#73</a>), we need to use <a href=https://github.com/clusterpedia-io/clusterpedia/blob/v0.0.9-alpha/hack/clean-clusterconfigs.sh>cealn-clusterconfigs.sh</a> in 0.0.9-alpha to clean up the cluster shortcut in the <em>.kube/config</em></p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -sfL https://raw.githubusercontent.com/clusterpedia-io/clusterpedia/v0.0.9-alpha/hack/clean-clusterconfigs.sh <span style=color:#000;font-weight:700>|</span> sh -
</code></pre></div><p>Backup and delete the <code>PediaCluster</code> resources.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl get pediacluster -o yaml &gt; clusters.yaml.bak

kubectl delete pediacluster --all
</code></pre></div><p>After all <code>PediaCluster</code> resources have been deleted, remove the <code>PediaCluster CRD</code></p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl delete crd pediaclusters.clusters.clusterpedia.io
</code></pre></div><p>Remove the <code>APIServices</code> used to register the Aggregated API</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl delete apiservices v1alpha1.pedia.clusterpedia.io
</code></pre></div><h2 id=upgrade-clusterpedia>Upgrade Clusterpedia</h2>
<p>Create <code>PediaCluster CRD</code>, and upgrade <code>Clusterpedia APIServer</code> and <code>Clustersynchro Manager</code>.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#000>DEPLOY_YAML_PATH</span><span style=color:#ce5c00;font-weight:700>=</span>https://raw.githubusercontent.com/clusterpedia-io/clusterpedia/v0.1.0/deploy
<span style=color:#000>CRD_YAML_PATH</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$DEPLOY_YAML_PATH</span>/crds

kubectl apply -f <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    <span style=color:#000>$CRD_YAML_PATH</span>/cluster.clusterpedia.io_pediaclusters.yaml,<span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    <span style=color:#000>$DEPLOY_YAML_PATH</span>/clusterpedia_clustersynchro_manager_deployment.yaml,<span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    <span style=color:#000>$DEPLOY_YAML_PATH</span>/clusterpedia_apiserver_deployment.yaml,<span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    <span style=color:#000>$DEPLOY_YAML_PATH</span>/clusterpedia_apiserver_apiservice.yaml
</code></pre></div><p>We can also download the YAML locally, or pull the <a href=https://github.com/clusterpedia-io/clusterpedia>clusterpedia</a> locally and go to <em>./deploy</em> directory and run <code>kubectl apply</code></p>
<h2 id=re-import-the-clusters>Re-import the clusters</h2>
<p>Since the APIVersion and schema of <code>PediaCluster</code> have been optimized for incompatibility,
it it necessary to recreate <code>PediaCluster</code> based on the backed up <em>clusters.yaml.bak</em>.</p>
<p>The current example of <code>PediaCluster</code>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster.clusterpedia.io/v1alpha2</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PediaCluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>apiserver</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;https://10.30.43.43:6443&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>caData</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>tokenData</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>certData</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>keyData</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>syncResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>     </span>- <span style=color:#000>deployments</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>     </span>- <span style=color:#000>pods</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><p>There are three main changes compared to 0.0.9-alpha:</p>
<ul>
<li><code>apiVersion</code>: <em>clusters.clusterpedia.io/v1alpha1</em> -> <em>cluster.clusterpedia.io/v1alpha2</em></li>
<li><code>spec.apiserverURL</code> -> <code>spec.apiserver</code></li>
<li><code>spec.resources</code> -> <code>spec.syncResources</code></li>
</ul>
<blockquote>
<p>The specific changes can be viewed: <a href=https://github.com/clusterpedia-io/clusterpedia/pull/70>#70</a>
<a href=https://github.com/clusterpedia-io/clusterpedia/pull/67>#67</a>
<a href=https://github.com/clusterpedia-io/clusterpedia/pull/76>#76</a>
<a href=https://github.com/clusterpedia-io/clusterpedia/pull/77>#77</a></p>
</blockquote>
<p>Create new pediaclusters based on the old pediaclusters in <em>clusters.yaml.bak</em></p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster.clusterpedia.io/v1alpha2</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PediaCluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{}<span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>---</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster.clusterpedia.io/v1alpha2</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PediaCluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster-2</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{}<span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><p>View clusters status</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl get pediacluster
</code></pre></div><p>Configure the cluster shortcut for kubectl</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -sfL https://raw.githubusercontent.com/clusterpedia-io/clusterpedia/v0.1.0/hack/gen-clusterconfigs.sh <span style=color:#000;font-weight:700>|</span> sh -
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-5a9086c52772fbac4aea92a7ce0b36db>Clusterpedia with kubectl support to retrieve multicluster resources</h1>
<div class="td-byline mb-4">
<time datetime=2021-12-03 class=text-muted>Friday, December 03, 2021</time>
</div>
<p>This name Clusterpedia is inspired by Wikipedia. It is an encyclopedia of multi-cluster to synchronize, search for, and simply control multi-cluster resources. Clusterpedia can synchronize resources with multiple clusters and provide more powerful search features on the basis of compatibility with Kubernetes OpenAPI to help you effectively get any multi-cluster resource that you are looking for in a quick and easy way.</p>
<blockquote>
<p>The capability of Clusterpedia is not only to search for and view but also simply control resources in the future, just like Wikipedia that supports for editing entries.</p>
</blockquote>
<h2 id=architecture-span-iddesignspan>Architecture <span id=design></span></h2>
<p>The architecture diagram of Clusterpedia is as follows:</p>
<div align=center><img src="https://github.com/clusterpedia-io/clusterpedia/blob/main/docs/images/arch.png?raw=true" style=width:900px></div>
The architecture consists of four parts:
<ul>
<li><strong>Clusterpedia APIServer</strong>: Register to Kube APIServer by the means of Aggregated API and provide services through a unified entrance</li>
<li><strong>ClusterSynchro Manager</strong>: Manage the Cluster Synchro that is used to synchronize cluster resources</li>
<li><strong>Storage Layer</strong>: Connect with a specific storage component and then register to Clusterpedia APIServer and ClusterSynchro Manager via a storage interface</li>
<li><strong>Storage component</strong>: A specific storage facility such as MySQL, postgres, redis or other graph databases</li>
</ul>
<p>In addition, Clusterpedia will use the custom resource <em>PediaCluster</em> to implement cluster authentication and synchronize the resource configuration.</p>
<p>Clusterpedia also provides a default storage layer that can connect with MySQL and postgres.</p>
<blockquote>
<p>Clusterpedia does not care about the specific storage settings used by users,
you can choose or implement the storage layer according to your own needs and then register the storage layer in Clusterpedia as a plug-in</p>
</blockquote>
<h3 id=featuresspan-idfeaturesspan>Features<span id=features></span></h3>
<ul>
<li><input checked disabled type=checkbox> Support for complex search, filters, sorting, paging, and more</li>
<li><input disabled type=checkbox> Support for requesting relevant resources when you query resources</li>
<li><input checked disabled type=checkbox> Unify the search entry for master clusters and multi-cluster resources</li>
<li><input checked disabled type=checkbox> Compatible with kubernetes OpenAPI, where you can directly use kubectl for multi-cluster search without any third-party plug-ins or tools</li>
<li><input checked disabled type=checkbox> Compatible with synchronizing different versions of cluster resources, not restricted by the version of master cluster</li>
<li><input checked disabled type=checkbox> High performance and low memory consumption for resource synchronization</li>
<li><input checked disabled type=checkbox> Automatically start/stop resource synchronization according to the current health status of the cluster
-<input disabled type=checkbox> Support for plug-in storage layer. You can use other storage components to customize the storage layer according to your needs.</li>
<li><input checked disabled type=checkbox> High availability</li>
</ul>
<blockquote>
<p>The above unimplemented features are already in the <a href=#roadmap>Roadmap</a></p>
</blockquote>
<h2 id=deploymentspan-iddeploymentspan>Deployment<span id=deployment></span></h2>
<p>For details on the deployment process, see <a href=/docs/installation>Instaling Clusterpedia</a>, which highlights how to use clusterpedia.</p>
<h2 id=synchronize-cluster-resourcesspan-idgetspan>Synchronize cluster resources<span id=get></span></h2>
<p>After deploying clusterpedia crds, you can use kubectl to operate <em>PediaCluster</em> resources.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl get pediaclusters
</code></pre></div><p>In the examples directory, you can check examples of <em>PediaCluster</em>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>clusters.clusterpedia.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PediaCluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>apiserverURL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;https://10.30.43.43:6443&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>caData</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>tokenData</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>certData</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>keyData</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>     </span>- <span style=color:#000>deployments</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>     </span>- <span style=color:#000>pods</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><p>The configuration of <em>PediaCluster</em> can be divided into two parts:</p>
<ul>
<li><strong>Cluster authentication</strong></li>
<li><strong>Synchronize a specific resource <code>.spec.resources</code></strong></li>
</ul>
<h3 id=cluster-authentication>Cluster authentication</h3>
<p>The fields of <code>caData</code>, <code>tokenData</code>, <code>certData</code>, and <code>keyData</code> can be used for cluster verification.</p>
<blockquote>
<p>Currently it does not support for getting the relevant verification information from ConfigMap or Secret.
However, the information is already in the <a href=#roadmap>Roadmap</a>.</p>
</blockquote>
<p>When setting the verification field, you shall use the strings encoded by base64.</p>
<p>The <code>. /examples</code> directory provides the rbac yaml <code>clusterpedia_synchro_rbac.yaml</code>, which can be used to easily obtain the permission token for a subcluster.</p>
<p>Deploy the yaml in the subcluster and get the proper token and CA certificate.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ <span style=color:#8f5902;font-style:italic># Switch to the sub-cluster to create rbac related resources</span>
$ kubectl apply -f examples/clusterpedia_synchro_rbac.yaml
$ <span style=color:#000>SYNCHRO_TOKEN</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>kubectl get secret <span style=color:#204a87;font-weight:700>$(</span>kubectl get serviceaccount clusterpedia-synchro -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.secrets[0].name}&#39;</span><span style=color:#204a87;font-weight:700>)</span> -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.data.token}&#39;</span><span style=color:#204a87;font-weight:700>)</span>
$ <span style=color:#000>SYNCHRO_CA</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>kubectl get secret <span style=color:#204a87;font-weight:700>$(</span>kubectl get serviceaccount clusterpedia-synchro -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.secrets[0].name}&#39;</span><span style=color:#204a87;font-weight:700>)</span> -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.data.ca\.crt}&#39;</span><span style=color:#204a87;font-weight:700>)</span>
</code></pre></div><p>Copy <em>./examples/pediacluster.yaml</em>, modify <code>.spec.apiserverURL</code> and <code>.metadata.name</code> fields, and fill <code>$SYNCHRO_TOKEN</code> and <code>$SYNCHRO_CA</code> into <code>tokenData</code> and <code>caData</code>.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl apply -f cluster-1.yaml
pediacluster.clusters.clusterpedia.io/cluster-1 created
</code></pre></div><h3 id=synchronize-resources>Synchronize resources</h3>
<p>You can specify the synchronized resources by setting <code>group</code> in the <code>spec.resources</code> field and the <code>resources</code> section under <code>group</code>.</p>
<p>You can also view the resource synchronization status in the <code>status</code> section:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>status:
  conditions:
  - lastTransitionTime: <span style=color:#4e9a06>&#34;2021-12-02T04:00:45Z&#34;</span>
    message: <span style=color:#4e9a06>&#34;&#34;</span>
    reason: Healthy
    status: <span style=color:#4e9a06>&#34;True&#34;</span>
    type: Ready
  resources:
  - group: <span style=color:#4e9a06>&#34;&#34;</span>
    resources:
    - kind: Pod
      namespaced: <span style=color:#204a87>true</span>
      resource: pods
      syncConditions:
      - lastTransitionTime: <span style=color:#4e9a06>&#34;2021-12-02T04:00:45Z&#34;</span>
        status: Syncing
        storageVersion: v1
        version: v1
  - group: apps
    resources:
    - kind: Deployment
      namespaced: <span style=color:#204a87>true</span>
      resource: deployments
      syncConditions:
      - lastTransitionTime: <span style=color:#4e9a06>&#34;2021-12-02T04:00:45Z&#34;</span>
        status: Syncing
        storageVersion: v1
        version: v1
  version: v1.22.2
</code></pre></div><h2 id=search-for-resourcesspan-idviewspan>Search for resources<span id=view></span></h2>
<p>After configuring the resources to be synchronized, you can search for the cluster resources. Clusterpedia supports two types of resource search:</p>
<ul>
<li>Search for resources that are compatible with Kubernetes OpenAPI</li>
<li>Search for <code>Collection Resource</code></li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl api-resources <span style=color:#000;font-weight:700>|</span> grep pedia.clusterpedia.io
collectionresources     pedia.clusterpedia.io/v1alpha1  <span style=color:#204a87>false</span>   CollectionResource
resources               pedia.clusterpedia.io/v1alpha1  <span style=color:#204a87>false</span>   Resources
</code></pre></div><p>In order to facilitate and well use kubectl for searching, you&rsquo;d better create a &lsquo;shortcut&rsquo; for searching the sub-cluster through <code>make gen-clusterconfig</code>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ make gen-clusterconfigs
./hack/gen-clusterconfigs.sh
Current Context: kubernetes-admin@kubernetes
Current Cluster: kubernetes
        Server: https://10.6.11.11:6443
        TLS Server Name:
        Insecure Skip TLS Verify:
        Certificate Authority:
        Certificate Authority Data: ***
Cluster <span style=color:#4e9a06>&#34;clusterpedia&#34;</span> set.
Cluster <span style=color:#4e9a06>&#34;cluster-1&#34;</span> set.
</code></pre></div><p>Use the <code>kubectl config get-clusters</code> command to view the currently supported clusters.</p>
<p>In this case, Clusterpedia is a special cluster used to search for multi-clusters by using <code>kubectl --cluster clusterpedia</code>.</p>
<h3 id=multi-cluster-resource-search>Multi-cluster resource search</h3>
<p>First check which resources are synchronized. You cannot find a resource until it is properly synchronized:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl --cluster clusterpedia api-resources
NAME          SHORTNAMES   APIVERSION   NAMESPACED   KIND
pods          po           v1           <span style=color:#204a87>true</span>         Pod
deployments   deploy       apps/v1      <span style=color:#204a87>true</span>         Deployment
</code></pre></div><p>You can check the currently synchronized resources including pods and deployments.apps.</p>
<p><strong>Get deployments in the <code>kube-system</code> namespace of all clusters:</strong></p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl --cluster clusterpedia get deployments -n kube-system
CLUSTER     NAME                      READY   UP-TO-DATE   AVAILABLE   AGE
cluster-1   coredns                   2/2     <span style=color:#0000cf;font-weight:700>2</span>            <span style=color:#0000cf;font-weight:700>2</span>           68d
cluster-2   calico-kube-controllers   1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           64d
cluster-2   coredns                   2/2     <span style=color:#0000cf;font-weight:700>2</span>            <span style=color:#0000cf;font-weight:700>2</span>           64d
</code></pre></div><p><strong>Get deployments in the two namespaces <code>kube-system</code> and <code>default</code> of all clusters:</strong></p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl --cluster clusterpedia get deployments -A -l <span style=color:#4e9a06>&#34;search.clusterpedia.io/namespaces in (kube-system, default)&#34;</span>
NAMESPACE     CLUSTER     NAME                      READY   UP-TO-DATE   AVAILABLE   AGE
kube-system   cluster-1   coredns                   2/2     <span style=color:#0000cf;font-weight:700>2</span>            <span style=color:#0000cf;font-weight:700>2</span>           68d
kube-system   cluster-2   calico-kube-controllers   1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           64d
kube-system   cluster-2   coredns                   2/2     <span style=color:#0000cf;font-weight:700>2</span>            <span style=color:#0000cf;font-weight:700>2</span>           64d
default       cluster-2   dd-airflow-scheduler      0/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>0</span>           54d
default       cluster-2   dd-airflow-web            0/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>0</span>           54d
default       cluster-2   hello-world-server        1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           27d
default       cluster-2   keycloak                  1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           52d
default       cluster-2   keycloak-02               1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           41d
default       cluster-2   my-nginx                  1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           40d
default       cluster-2   nginx-dev                 1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           15d
default       cluster-2   openldap                  1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           41d
default       cluster-2   phpldapadmin              1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           41d
</code></pre></div><p><strong>Get deployments in the <code>kube-system</code> and <code>default</code> namespaces in cluster-1 and cluster-2:</strong></p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl --cluster clusterpedia get deployments -A -l <span style=color:#4e9a06>&#34;search.clusterpedia.io/clusters in (cluster-1, cluster-2),\
</span><span style=color:#4e9a06>search.clusterpedia.io/namespaces in (kube-system,default)&#34;</span>
NAMESPACE     CLUSTER     NAME                      READY   UP-TO-DATE   AVAILABLE   AGE
kube-system   cluster-1   coredns                   2/2     <span style=color:#0000cf;font-weight:700>2</span>            <span style=color:#0000cf;font-weight:700>2</span>           68d
kube-system   cluster-2   calico-kube-controllers   1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           64d
kube-system   cluster-2   coredns                   2/2     <span style=color:#0000cf;font-weight:700>2</span>            <span style=color:#0000cf;font-weight:700>2</span>           64d
default       cluster-2   dd-airflow-scheduler      0/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>0</span>           54d
default       cluster-2   dd-airflow-web            0/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>0</span>           54d
default       cluster-2   hello-world-server        1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           27d
default       cluster-2   keycloak                  1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           52d
default       cluster-2   keycloak-02               1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           41d
default       cluster-2   my-nginx                  1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           40d
default       cluster-2   nginx-dev                 1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           15d
default       cluster-2   openldap                  1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           41d
default       cluster-2   phpldapadmin              1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           41d
</code></pre></div><p><strong>Get deployments in the <code>kube-system</code> and <code>default</code> namespaces in cluster-1 and cluster-2:</strong></p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl --cluster clusterpedia get deployments -A -l <span style=color:#4e9a06>&#34;search.clusterpedia.io/clusters in (cluster-1, cluster-2),\
</span><span style=color:#4e9a06>search.clusterpedia.io/namespaces in (kube-system,default),\
</span><span style=color:#4e9a06>search.clusterpedia.io/orderby=name&#34;</span>
NAMESPACE     CLUSTER     NAME                      READY   UP-TO-DATE   AVAILABLE   AGE
kube-system   cluster-2   calico-kube-controllers   1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           64d
kube-system   cluster-1   coredns                   2/2     <span style=color:#0000cf;font-weight:700>2</span>            <span style=color:#0000cf;font-weight:700>2</span>           68d
kube-system   cluster-2   coredns                   2/2     <span style=color:#0000cf;font-weight:700>2</span>            <span style=color:#0000cf;font-weight:700>2</span>           64d
default       cluster-2   dao-2048-2048             1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           21d
default       cluster-2   dd-airflow-scheduler      0/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>0</span>           54d
default       cluster-2   dd-airflow-web            0/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>0</span>           54d
default       cluster-2   hello-world-server        1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           27d
default       cluster-2   keycloak                  1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           52d
default       cluster-2   keycloak-02               1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           41d
default       cluster-2   my-nginx                  1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           40d
default       cluster-2   nginx-dev                 1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           15d
default       cluster-2   openldap                  1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           41d
default       cluster-2   phpldapadmin              1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           41d
</code></pre></div><h3 id=search-a-specific-cluster>Search a specific cluster</h3>
<p><strong>If you want to search a specific cluster for any resource therein, you can add &ndash;cluster to specify the cluster name:</strong></p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl --cluster cluster-1 get deployments -A
NAMESPACE                           CLUSTER     NAME                                            READY   UP-TO-DATE   AVAILABLE   AGE
calico-apiserver                    cluster-1   calico-apiserver                                1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           68d
calico-system                       cluster-1   calico-kube-controllers                         1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           68d
calico-system                       cluster-1   calico-typha                                    1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           68d
capi-system                         cluster-1   capi-controller-manager                         1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           42d
capi-kubeadm-bootstrap-system       cluster-1   capi-kubeadm-bootstrap-controller-manager       1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           42d
capi-kubeadm-control-plane-system   cluster-1   capi-kubeadm-control-plane-controller-manager   1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           42d
capv-system                         cluster-1   capv-controller-manager                         1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           42d
cert-manager                        cluster-1   cert-manager                                    1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           42d
cert-manager                        cluster-1   cert-manager-cainjector                         1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           42d
cert-manager                        cluster-1   cert-manager-webhook                            1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           42d
clusterpedia-system                 cluster-1   clusterpedia-apiserver                          1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           27m
clusterpedia-system                 cluster-1   clusterpedia-clustersynchro-manager             1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           27m
clusterpedia-system                 cluster-1   clusterpedia-internalstorage-mysql              1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           29m
kube-system                         cluster-1   coredns                                         2/2     <span style=color:#0000cf;font-weight:700>2</span>            <span style=color:#0000cf;font-weight:700>2</span>           68d
tigera-operator                     cluster-1   tigera-operator                                 1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           68d
</code></pre></div><p>Except for <code>search.clusterpedia.io/clusters</code>, the support for other complex queries is same as that for multi-cluster search.</p>
<p>If you want to learn about the details of a resource, you need to specify which cluster it is:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl --cluster cluster-1 -n kube-system get deployments coredns -o wide
CLUSTER     NAME      READY   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS   IMAGES                                                   SELECTOR
cluster-1   coredns   2/2     <span style=color:#0000cf;font-weight:700>2</span>            <span style=color:#0000cf;font-weight:700>2</span>           68d   coredns      registry.aliyuncs.com/google_containers/coredns:v1.8.4   k8s-app<span style=color:#ce5c00;font-weight:700>=</span>kube-dns
</code></pre></div><h3 id=complex-search>Complex search</h3>
<p>Clusterpedia supports for the following complex search:</p>
<ul>
<li>Specify one or more <code>cluster names</code></li>
<li>Specify one or more <code>namespaces</code></li>
<li>Specify one or more <code>resource names</code></li>
<li>Specify how to <code>sort</code> multiple fields</li>
<li><code>Paging</code> function, by which you can specify its size and offset</li>
<li><code>filter by labels</code></li>
</ul>
<p>The actual effect of field sorting depends on the storage layer. By default, the storage layer supports for sorting according to <code>cluster</code>, <code>name</code>, <code>namespace</code>, <code>created_at</code>, and <code>resource_version</code> in a normal or reverse order.</p>
<h3 id=how-search-conditions-are-applied>How search conditions are applied</h3>
<p>The above example demonstrates how you can use kubectl to search for resources. Where, complex search conditions are applied via a <code>label</code>. Clusterpedia also supports for using these search conditions directly through <code>url query</code>.</p>
<table>
<thead>
<tr>
<th>role</th>
<th>label key</th>
<th>url query</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Specified resource name</td>
<td>search.clusterpedia.io/names</td>
<td>names</td>
<td><code>?names=pod-1,pod-2</code></td>
</tr>
<tr>
<td>Specified namespace</td>
<td>search.clusterpedia.io/namespaces</td>
<td>namespaces</td>
<td><code>?namespaces=kube-system,default</code></td>
</tr>
<tr>
<td>Specified cluster name</td>
<td>search.clusterpedia.io/clusters</td>
<td>clusters</td>
<td><code>?clusters=cluster-1,cluster-2</code></td>
</tr>
<tr>
<td>Sort by specified fileds</td>
<td>search.clusterpedia.io/orderby</td>
<td>orderby</td>
<td><code>?orderby=name desc,namespace</code></td>
</tr>
<tr>
<td>Specified size</td>
<td>search.clusterpedia.io/size</td>
<td>size</td>
<td><code>?size=100</code></td>
</tr>
<tr>
<td>Specified offset</td>
<td>search.clsuterpedia.io/offset</td>
<td>offset</td>
<td><code>?offset=10</code></td>
</tr>
</tbody>
</table>
<p>The operators of <code>label key</code> include ==, =, !=, in, not in. For the <code>size</code> condition, kubectl can specify a size by <code>--chunk-size</code> instead of the <code>label key</code>.</p>
<h3 id=collection-resource>Collection Resource</h3>
<p>Clusterpedia can also perform more advanced aggregation of resources. For example, you can use <code>Collection Resource</code> to get a set of different resources at once.</p>
<p>Let&rsquo;s first check which <code>Collection Resource</code> currently Clusterpedia supports:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl get collectionresources
NAME        RESOURCES
workloads   deployments.apps,daemonsets.apps,statefulsets.apps
</code></pre></div><p>By getting workloads, you can get a set of resources aggregated by deployment, daemonset, and statefulset, and <code>Collection Resource</code> also supports for all complex queries.</p>
<p><strong><code>kubectl get collectionresources workloads</code> will get the corresponding resources of all namespaces in all clusters by default:</strong></p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl get collectionresources workloads
CLUSTER     GROUP   VERSION   KIND         NAMESPACE                     NAME                                          AGE
cluster-1   apps    v1        DaemonSet    kube-system                   vsphere-cloud-controller-manager              63d
cluster-2   apps    v1        Deployment   kube-system                   calico-kube-controllers                       109d
cluster-2   apps    v1        Deployment   kube-system                   coredns-coredns                               109d
</code></pre></div><blockquote>
<p>Add the collection of Daemonset in cluster-1 and some of the above output is cut out</p>
</blockquote>
<p>Due to the limitation of kubectl, you cannot use complex queries in kubectl and can only be queried by <code>url query</code>.</p>
<h2 id=proposal>Proposal</h2>
<h3 id=perform-more-complex-control-over-resourcesspan-idcomplicatedspan>Perform more complex control over resources<span id=complicated></span></h3>
<p>In addition to resource search, similar to Wikipedia, Clusterpedia should also have simple capability of resource control, such as watch, create, delete, update, and more.</p>
<p>In fact, a write action is implemented by double write + response.</p>
<p><strong>We will discuss this feature and decide whether we should implement it according to the community needs</strong></p>
<h3 id=automatic-discovery-and-resource-synchronizationspan-iddiscoveryspan>Automatic discovery and resource synchronization<span id=discovery></span></h3>
<p>The resource used to represent the cluster in Clusterpedia is called <em>PediaCluster</em>, not a simple Cluster.</p>
<p>**This is because Clusterpedia was originally designed to build on the existing multi-cluster management platform. **</p>
<p>In order to keep the original intention, the first issue is that Clusterpedia should not conflict with the resources in the existing multi-cluster platform. Cluster is a very common resource name that represents a cluster.</p>
<p>In addition, in order to better connect with the existing multi-cluster platform and enable the connected clusters automatically complete resource synchronization, we need a new mechanism to discover clusters. This discovery mechanism needs to solve the following issues:</p>
<ul>
<li>Get the authentication info to access the cluster</li>
<li>Configure conditions that trigger the lifecycle of PediaCluster</li>
<li>Set the default policy and prefix name for resource synchronization</li>
</ul>
<p>This feature will be discussed and implemented in detail in Q1 or Q2 2022.</p>
<h2 id=roadmapspan-idroadmapspan>Roadmap<span id=roadmap></span></h2>
<p>Currently, it is only a tentative roadmap and the specific schedule depends on the community needs.</p>
<p><strong>About some features not added to Roadmap, you can discuss in <a href=https://github.com/clusterpedia-io/clusterpedia/issues>issues</a>.</strong></p>
<h3 id=q4-2021>Q4 2021</h3>
<ul>
<li><a href=https://github.com/clusterpedia-io/clusterpedia/issues/4>Support for cropping field</a></li>
<li>Synchronize custom resources</li>
</ul>
<h3 id=q1-2022>Q1 2022</h3>
<ul>
<li>Support for the plug-in storage layer</li>
<li>Implement <a href=#discovery>automatic discovery and resource synchronization</a></li>
</ul>
<h3 id=q2-2022>Q2 2022</h3>
<ul>
<li>Support for <a href=#complicated>more control over cluster resources</a>, such as watch/create/update/delete operations</li>
<li>The storage layer supports for custom Collection Resource by default</li>
<li>Support for requests with relevant resources</li>
</ul>
<h2 id=remarks>Remarks</h2>
<h3 id=multi-cluster-network-connectivity>Multi-cluster network connectivity</h3>
<p>Clusterpedia does not actually solve the problem of network connectivity in a multi-cluster environment. You can use tools such as <a href=https://github.com/kubesphere/tower>tower</a> to connect and access sub-clusters, or use <a href=https://github.com/submariner-io/submariner>submariner</a> or <a href=https://github.com/skupperproject/skupper>skupper</a> to solve cross-cluster network problems.</p>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/clusterpedia-io aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack>
<a class=text-white target=_blank rel=noopener href=https://cloud-native.slack.com/messages/clusterpedia aria-label=Slack>
<i class="fab fa-slack"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list">
<a class=text-white target=_blank rel=noopener href=mailto:clusterpedia@googlegroups.com aria-label="Developer mailing list">
<i class="fa fa-envelope"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2023 The Clusterpedia Authors All Rights Reserved</small>
<p class=mt-2><a href=/about/>About Clusterpedia</a></p>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.8ab8f81ff7e1454d30024cd6f956d4d341c3a97e2a673f988065f2ee4e147922.js integrity="sha256-irj4H/fhRU0wAkzW+VbU00HDqX4qZz+YgGXy7k4UeSI=" crossorigin=anonymous></script>
<script src=https://cdn.bootcdn.net/ajax/libs/asciinema-player/2.6.1/asciinema-player.min.js></script>
</body>
</html>
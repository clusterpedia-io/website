<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Clusterpedia.io â€“ Clusterpedia</title><link>/</link><description>Recent content in Clusterpedia on Clusterpedia.io</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Fri, 29 Apr 2022 00:00:00 +0000</lastBuildDate><atom:link href="/index.xml" rel="self" type="application/rss+xml"/><item><title>Blog: Clusterpedia is Listed in the CNCF Cloud Native Landscape</title><link>/blog/2022/04/29/clusterpedia-is-listed-in-the-cncf-cloud-native-landscape/</link><pubDate>Fri, 29 Apr 2022 00:00:00 +0000</pubDate><guid>/blog/2022/04/29/clusterpedia-is-listed-in-the-cncf-cloud-native-landscape/</guid><description>
&lt;!--
åœ¨ CNCF æœ€æ–°å‘å¸ƒçš„äº‘åŽŸç”Ÿå…¨æ™¯å›¾ (Cloud Native Landscape) ä¸­ï¼ŒClusterpediaå…¥é€‰Orchestration &amp; Management (ç¼–æŽ’ä¸Žç®¡ç†) å±‚çš„ Scheduling &amp; Orchestration (è°ƒåº¦ä¸Žç¼–æŽ’) è±¡é™ï¼Œæˆä¸º CNCF æŽ¨èçš„äº‘åŽŸç”Ÿå¤šé›†ç¾¤å¤æ‚æ£€ç´¢å·¥å…·ã€‚
-->
&lt;p>In the updated CNCF Cloud Native Landscape, Clusterpedia was listed into the Scheduling &amp;amp; Orchestration quadrant of the Orchestration &amp;amp; Management layer, becoming a cloud-native multi-cluster complex retrieval tool recommended by CNCF.&lt;/p>
&lt;p>&lt;a href="https://landscape.cncf.io/card-mode?category=scheduling-orchestration&amp;grouping=category&amp;selected=clusterpedia">&lt;img class="aligncenter wp-image-7957 size-full" src="https://p26.toutiaoimg.com/origin/tos-cn-i-qvj2lq49k0/3871965400044875af28b263a790504c" alt="" width="800" height="500" data-tag="bdshare">&lt;/a>&lt;/p>
&lt;hr>
&lt;!--
CNCF å…¨ç§° Cloud Native Computing Foundation (äº‘åŽŸç”Ÿè®¡ç®—åŸºé‡‘ä¼š)ï¼Œéš¶å±žäºŽ Linux åŸºé‡‘ä¼šï¼Œæˆç«‹äºŽ 2015 å¹´ 12 æœˆï¼Œæ˜¯éžè¥åˆ©æ€§ç»„ç»‡ï¼Œè‡´åŠ›äºŽåŸ¹è‚²å’Œç»´æŠ¤ä¸€ä¸ªåŽ‚å•†ä¸­ç«‹çš„å¼€æºç”Ÿæ€ç³»ç»Ÿï¼Œæ¥æŽ¨å¹¿äº‘åŽŸç”ŸæŠ€æœ¯ï¼Œæ™®åŠäº‘åŽŸç”Ÿåº”ç”¨ã€‚
äº‘åŽŸç”Ÿå…¨æ™¯å›¾ç”± CNCF ä»Ž 2016 å¹´ 12 æœˆå¼€å§‹ç»´æŠ¤ï¼Œæ±‡æ€»äº†ç¤¾åŒºæˆç†Ÿå’Œä½¿ç”¨èŒƒå›´è¾ƒå¹¿ã€å…·æœ‰æœ€ä½³å®žè·µçš„äº§å“å’Œæ–¹æ¡ˆï¼Œå¹¶åŠ ä»¥åˆ†ç±»ï¼Œä¸ºä¼ä¸šæž„å»ºäº‘åŽŸç”Ÿä½“ç³»æä¾›å‚è€ƒï¼Œåœ¨äº‘ç”Ÿæ€ç ”å‘ã€è¿ç»´é¢†åŸŸå…·æœ‰å¹¿æ³›å½±å“åŠ›ã€‚
-->
&lt;p>Cloud Native Computing Foundation (CNCF) belongs to the Linux Foundation and was established in December 2015. It is a non-profit organization dedicated to fostering and maintaining a vendor-neutral open source ecosystem to promote cloud native technologies and make cloud native universal and sustainable.&lt;/p>
&lt;p>The Cloud Native Landscape has been maintained by CNCF since December 2016. It is intended as a map to list popular projects with best practices in the community, and categorizes them in the cloud native space to provide reference for enterprises to build a cloud native ecosystem. It has extensive influence on the development, operation, and maintenance of cloud native technologies.&lt;/p></description></item><item><title>Blog: Clusterpedia v0.2.0 Release</title><link>/blog/2022/04/12/clusterpedia-v0.2.0-release/</link><pubDate>Tue, 12 Apr 2022 00:00:00 +0000</pubDate><guid>/blog/2022/04/12/clusterpedia-v0.2.0-release/</guid><description>
&lt;h2 id="use-helm-to-install">Use helm to install&lt;/h2>
&lt;p>Users can already use Helm to install Clusterpedia:&lt;/p>
&lt;pre>&lt;code>$ helm install clusterpedia . \
--namespace clusterpedia-system \
--create-namespace \
--set persistenceMatchNode={{ LOCAL_PV_NODE }} \
# --set installCRDs=true
&lt;/code>&lt;/pre>
&lt;p>&lt;a href="https://github.com/clusterpedia-io/clusterpedia/tree/main/charts">Lean More&lt;/a>&lt;/p>
&lt;h2 id="use-the-kube-config-to-import-a-cluster">Use the Kube Config to import a cluster&lt;/h2>
&lt;p>For v0.1.0, users need to Configure the address for the imported cluster and the authentication information.&lt;/p>
&lt;pre>&lt;code>apiVersion: cluster.clusterpedia.io/v1alpha2
kind: PediaCluster
metadata:
name: cluster-example
spec:
apiserver: &amp;quot;https://10.30.43.43:6443&amp;quot;
caData:
tokenData:
certData:
keyData:
syncResources: []
&lt;/code>&lt;/pre>
&lt;p>In v0.2.0, the &lt;code>PediaCluster&lt;/code> added the &lt;code>spec.kubeconfig&lt;/code> field so that users can use &lt;code>kube config&lt;/code> to import the cluster directly.&lt;/p>
&lt;p>First you need to base64 encode the kube config for the imported cluster.&lt;/p>
&lt;pre>&lt;code>$ base64 ./kubeconfig.yaml
&lt;/code>&lt;/pre>
&lt;p>Set the content after the base64 to PediaCluster &lt;code>spec.kubeconfig&lt;/code>, in addition &lt;code>spec.apiserver&lt;/code> and other authentication fields donâ€™t need to set.&lt;/p>
&lt;pre>&lt;code>apiVersion: cluster.clusterpedia.io/v1alpha2
kind: PediaCluster
metadata:
name: cluster-example
spec:
kubeconfig: **base64 kubeconfig**
syncResources: []
&lt;/code>&lt;/pre>
&lt;p>However, since the cluster address is configured in kube config, the &lt;strong>APIServer&lt;/strong> is empty when you use kubectl get pediacluster.&lt;/p>
&lt;pre>&lt;code>$ kubectl get pediacluster
NAME APISERVER VERSION STATUS
cluster-example v1.22.2 Healthy
&lt;/code>&lt;/pre>
&lt;p>Mutating addmission webhooks will be added in the future to automatically set &lt;code>spec.apiserver&lt;/code>, currently if you want to show the cluster apiserver address when &lt;code>kubectl get pediacluster&lt;/code>, then you need to manually configure the &lt;code>spec.apiserver&lt;/code> field additionally.&lt;/p>
&lt;h2 id="new-search-feature">New Search Feature&lt;/h2>
&lt;h3 id="search-by-creation-time-interval">Search by creation time interval&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:left">Description&lt;/th>
&lt;th style="text-align:left">Search Label Key&lt;/th>
&lt;th style="text-align:left">URL Query&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:left">Since&lt;/td>
&lt;td style="text-align:left">search.clusterpedia.io/since&lt;/td>
&lt;td style="text-align:left">since&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Before&lt;/td>
&lt;td style="text-align:left">search.clusterpedia.io/before&lt;/td>
&lt;td style="text-align:left">before&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>The creation time interval used for the search is left closed and right open, &lt;strong>since &amp;lt;= creation time &amp;lt; before&lt;/strong>.&lt;/p>
&lt;p>There are four formats for creation time:&lt;/p>
&lt;ol>
&lt;li>&lt;code>Unix Timestamp&lt;/code> for ease of use will distinguish between units of &lt;code>s&lt;/code> or &lt;code>ms&lt;/code> based on the length of the timestamp. The 10-bit timestamp is in seconds, the 13-bit timestamp is in milliseconds.&lt;/li>
&lt;li>&lt;code>RFC3339&lt;/code> &lt;em>2006-01-02T15:04:05Z&lt;/em> or &lt;em>2006-01-02T15:04:05+08:00&lt;/em>&lt;/li>
&lt;li>&lt;code>UTC Date&lt;/code> &lt;em>2006-01-02&lt;/em>&lt;/li>
&lt;li>&lt;code>UTC Datetime&lt;/code> &lt;em>2006-01-02 15:04:05&lt;/em>&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>Because of the limitation of the kube label selector, the search label only supports &lt;code>Unix Timestamp&lt;/code> and &lt;code>UTC Date&lt;/code>.&lt;/p>
&lt;p>All formats are available using the url query method.&lt;/p>
&lt;/blockquote>
&lt;p>Look at what resources are under the default namespace&lt;/p>
&lt;pre>&lt;code>$ kubectl --cluster clusterpedia get pods
CLUSTER NAME READY STATUS RESTARTS AGE
cluster-example quickstart-ingress-nginx-admission-create--1-kxlnn 0/1 Completed 0 171d
cluster-example fake-pod-698dfbbd5b-wvtvw 1/1 Running 0 8d
cluster-example fake-pod-698dfbbd5b-74cjx 1/1 Running 0 21d
cluster-example fake-pod-698dfbbd5b-tmcw7 1/1 Running 0 8d
&lt;/code>&lt;/pre>
&lt;p>We use the creation time to filter the resources.&lt;/p>
&lt;pre>&lt;code>$ kubectl --cluster clusterpedia get pods -l &amp;quot;search.clusterpedia.io/since=2022-03-20&amp;quot;
CLUSTER NAME READY STATUS RESTARTS AGE
cluster-example fake-pod-698dfbbd5b-wvtvw 1/1 Running 0 8d
cluster-example fake-pod-698dfbbd5b-tmcw7 1/1 Running 0 8d
$ kubectl --cluster clusterpedia get pods -l &amp;quot;search.clusterpedia.io/before=2022-03-20&amp;quot;
CLUSTER NAME READY STATUS RESTARTS AGE
cluster-example quickstart-ingress-nginx-admission-create--1-kxlnn 0/1 Completed 0 171d
cluster-example fake-pod-698dfbbd5b-74cjx 1/1 Running 0 21d
&lt;/code>&lt;/pre>
&lt;h3 id="search-by-owner-name">Search by Owner Name&lt;/h3>
&lt;p>As of v0.1.0, we can specify ancestor or parent &lt;code>Owner UID&lt;/code> to query resources, but &lt;code>Owner UID&lt;/code> is not convenient to use, after all, you still need to know the UID of the Owner resource in advance.&lt;/p>
&lt;p>In v0.2.0, we support querying directly with &lt;code>Owner Name&lt;/code>, and the Owner query has been moved from experimental to released functionality, the prefix of &lt;strong>Search Label&lt;/strong> has been upgraded from &lt;em>internalstorage.c lusterpedia.io&lt;/em> to *search.clusterpedia.io *, and URL Query is provided.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:left">Role&lt;/th>
&lt;th style="text-align:left">search label key&lt;/th>
&lt;th style="text-align:left">url query&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:left">Specified Owner UID&lt;/td>
&lt;td style="text-align:left">search.clusterpedia.io/owner-uid&lt;/td>
&lt;td style="text-align:left">ownerUID&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Specified Owner Name&lt;/td>
&lt;td style="text-align:left">search.clusterpedia.io/owner-name&lt;/td>
&lt;td style="text-align:left">ownerName&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">SPecified Owner Group Resource&lt;/td>
&lt;td style="text-align:left">search.clusterpedia.io/owner-gr&lt;/td>
&lt;td style="text-align:left">ownerGR&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Specified Owner Seniority&lt;/td>
&lt;td style="text-align:left">&lt;code>internalstorage.clusterpedia.io/owner-seniority&lt;/code>&lt;/td>
&lt;td style="text-align:left">&lt;code>ownerSeniority&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;blockquote>
&lt;p>Note that when specifying &lt;code>Owner UID&lt;/code>, &lt;code>Owner Name&lt;/code> and &lt;code>Owner Group Resource&lt;/code> will be ignored.&lt;/p>
&lt;/blockquote>
&lt;pre>&lt;code>$ kubectl --cluster cluster-example get pods -l \
&amp;quot;search.clusterpedia.io/owner-name=fake-pod, \
search.clusterpedia.io/owner-seniority=1&amp;quot;
CLUSTER NAME READY STATUS RESTARTS AGE
cluster-example fake-pod-698dfbbd5b-wvtvw 1/1 Running 0 8d
cluster-example fake-pod-698dfbbd5b-74cjx 1/1 Running 0 21d
cluster-example fake-pod-698dfbbd5b-tmcw7 1/1 Running 0 8d
&lt;/code>&lt;/pre>
&lt;p>&lt;strong>In addition, to avoid multiple types of owner resources in some cases, we can use the&lt;/strong> &lt;code>Owner Group Resource&lt;/code> &lt;strong>to restrict the type of owner.&lt;/strong>&lt;/p>
&lt;pre>&lt;code>$ kubectl --cluster cluster-example get pods -l \
&amp;quot;search.clusterpedia.io/owner-name=fake-pod,\
search.clusterpedia.io/owner-gr=deployments.apps,\
search.clusterpedia.io/owner-seniority=1&amp;quot;
... some output
&lt;/code>&lt;/pre>
&lt;h3 id="fuzzy-search-base-on-resource-names">Fuzzy Search base on resource names&lt;/h3>
&lt;p>Since fuzzy search needs to be discussed further, it is temporarily provided as an experimental feature.&lt;/p>
&lt;p>Only the Search Label method is supported, URL Query isnâ€™t supported. |Role| search label key|url query| | &amp;ndash; | &amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash; | &amp;mdash;&amp;mdash;- | |Fuzzy Search for resource name|internalstorage.clusterpedia.io/fuzzy-name|-|&lt;/p>
&lt;pre>&lt;code>$ kubectl --cluster clusterpedia get deployments -l &amp;quot;internalstorage.clusterpedia.io/fuzzy-name=fake&amp;quot;
CLUSTER NAME READY UP-TO-DATE AVAILABLE AGE
cluster-example fake-pod 3/3 3 3 113d
&lt;/code>&lt;/pre>
&lt;p>You can use the in operator to pass multiple fuzzy arguments, so that you can filter out resources that have all strings in their names.&lt;/p>
&lt;h2 id="other-features">Other Features&lt;/h2>
&lt;p>In v0.1.0, searching the resources allow the number of remaining resources to be returned so that the user can calculate the total number of resources.&lt;/p>
&lt;p>This feature has been enhanced in v0.2.0. When offset is too large, &lt;code>remainingItemCount&lt;/code> may be negative, ensuring that the total number of resources can always be calculated.&lt;/p>
&lt;p>&lt;a href="https://clusterpedia.io/docs/usage/search/multi-cluster/#response-with-remaining-count">Lean More&lt;/a>&lt;/p>
&lt;h2 id="release-noteshttpsgithubcomclusterpedia-ioclusterpediareleases">&lt;a href="https://github.com/clusterpedia-io/clusterpedia/releases">Release Notes&lt;/a>&lt;/h2>
&lt;ul>
&lt;li>Support of using Helm Charts for installation (&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/53">#53&lt;/a>, &lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/125">#125&lt;/a>, @calvin0327, @wzshiming)&lt;/li>
&lt;li>&lt;code>PediaCluster&lt;/code> supports for importing a cluster using the kubeconfig (&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/115">#115&lt;/a>, @wzshiming)&lt;/li>
&lt;/ul>
&lt;h3 id="apiserver">APIServer&lt;/h3>
&lt;ul>
&lt;li>Support for filtering resources by a period of creation (&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/113">#113&lt;/a>, @cleverhu)&lt;/li>
&lt;li>Support for searching for resources by an Owner name. Now, the feature of &lt;code>Search by Owner&lt;/code> is officially released. (&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/91">#91&lt;/a>, @Iceber)&lt;/li>
&lt;/ul>
&lt;h3 id="default-storage-layer">Default Storage Layer&lt;/h3>
&lt;ul>
&lt;li>Support for fuzzy search by a resource name (&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/117">#117&lt;/a>, @cleverhu)&lt;/li>
&lt;li>&lt;code>RemainingItemCount&lt;/code> can be a negative number. We can still use &lt;code>offset + len(items) + remainingItemCount&lt;/code> to calculate the total amount of resources if the &lt;code>Offset&lt;/code> is too large. (&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/123">#123&lt;/a>, @cleverhu)&lt;/li>
&lt;/ul>
&lt;h3 id="bug-fixes">Bug Fixes&lt;/h3>
&lt;ul>
&lt;li>Fixed unnecessary &lt;code>json.Unmarshal&lt;/code> and improved performance when searching (&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/89">#89&lt;/a>, &lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/92">#92&lt;/a>, @Iceber)&lt;/li>
&lt;/ul>
&lt;h3 id="deprecation">Deprecation&lt;/h3>
&lt;ul>
&lt;li>&lt;code>Search by Owner&lt;/code> has been released as an official feature. &lt;code>internalstorage.clusterpedia.io/owner-name&lt;/code> and &lt;code>internalstorage.clusterpedia.io/owner-seniority&lt;/code> will be removed in the next release. (&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/91">#91&lt;/a>, @Iceber)&lt;/li>
&lt;/ul>
&lt;h3 id="other">Other&lt;/h3>
&lt;ul>
&lt;li>&lt;code>golangci-lint&lt;/code> is used as a static checking tool (&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/86">#86&lt;/a>, &lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/88">#88&lt;/a>, @Iceber)&lt;/li>
&lt;li>Added CI Workloads such as static checking and unit testing for code &lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/87">#87&lt;/a>, @Iceber)&lt;/li>
&lt;/ul></description></item><item><title>Blog: Quickly Deploy Clusterpedia with Helm</title><link>/blog/2022/04/11/quickly-deploy-clusterpedia-with-helm/</link><pubDate>Mon, 11 Apr 2022 00:00:00 +0000</pubDate><guid>/blog/2022/04/11/quickly-deploy-clusterpedia-with-helm/</guid><description>
&lt;!--å½“å‰ Clusterpedia å·²ç»æ”¯æŒé€šè¿‡ Helm æ¥å¿«é€Ÿéƒ¨ç½²ã€‚-->
&lt;p>Currently Clusterpedia has supported a rapid deployment with Helm.&lt;/p>
&lt;!--é¦–å…ˆéœ€è¦ä¿è¯å½“å‰çŽ¯å¢ƒå·²ç»å®‰è£… helm v3ã€‚-->
&lt;p>All of first, you need to check if helm v3 is installed in your current environment.&lt;/p>
&lt;!--
## å‡†å¤‡é˜¶æ®µ
æ‹‰å– Clusterpedia ä»“åº“ä»£ç ã€‚
> å½“å‰æš‚æ—¶è¿˜æœªå°† chart ä¸Šä¼ è‡³ charts å…¬å…±ä»“åº“ã€‚
-->
&lt;h2 id="preparation">Preparation&lt;/h2>
&lt;p>Pull the Clusterpedia repository.&lt;/p>
&lt;blockquote>
&lt;p>Currently, the chart has not been uploaded to the public charts repository.&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">git clone https://github.com/clusterpedia-io/clusterpedia.git
&lt;span style="color:#204a87">cd&lt;/span> clusterpedia/charts
&lt;/code>&lt;/pre>&lt;/div>&lt;!--
ç”±äºŽ clusterpedia ä½¿ç”¨ `bitnami/postgresql` å’Œ `bitnami/mysql` ä½œä¸ºå­˜å‚¨ç»„ä»¶å­ chartï¼Œ
æ‰€ä»¥éœ€è¦æ·»åŠ  bitnami ä»“åº“ï¼Œå¹¶æ›´æ–° clusterpedia chart çš„ä¾èµ–ã€‚
-->
&lt;p>Since Clusterpedia uses &lt;code>bitnami/postgresql&lt;/code> and &lt;code>bitnami/mysql&lt;/code> as subcharts of storage components, it is necessary to add the bitnami repository and update the dependencies of the clusterpedia chart.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">helm repo add bitnami https://charts.bitnami.com/bitnami
helm dependency build
&lt;/code>&lt;/pre>&lt;/div>&lt;!--
### é€‰æ‹©å­˜å‚¨ç»„ä»¶
Clusterpedia Chart é€šè¿‡å­ chart çš„æ–¹å¼ï¼Œæä¾›äº† `bitnami/postgresql` å’Œ `bitnami/mysql` ä¸¤æ¬¾å­˜å‚¨ç»„ä»¶å¯ä¾›é€‰æ‹©ã€‚
`postgresql` ä¸ºé»˜è®¤çš„å­˜å‚¨ç»„ä»¶ï¼Œå¦‚æžœæƒ³è¦ä½¿ç”¨ MySQLï¼Œé‚£ä¹ˆåœ¨åŽç»­å®‰è£…å‘½ä»¤ä¸­æ·»åŠ  `--set postgresql.enabled=false --set mysql.enabled=true`
æ›´å¤šå…³äºŽå­˜å‚¨ç»„ä»¶çš„é…ç½®ï¼Œå¯ä»¥å‚è€ƒ [bitnami/postgresql](https://github.com/bitnami/charts/tree/master/bitnami/postgresql) å’Œ [bitnami/mysql](https://github.com/bitnami/charts/tree/master/bitnami/mysql)ã€‚
**ç”¨æˆ·ä¹Ÿå¯ä»¥é€‰æ‹©ä¸å®‰è£…å­˜å‚¨ç»„ä»¶ï¼Œè€Œæ˜¯ä½¿ç”¨å¤–éƒ¨ç»„ä»¶ï¼Œç›¸å…³è®¾ç½®å¯ä»¥å‚è€ƒ charts/values.yaml**
-->
&lt;h3 id="choose-storage-components">Choose storage components&lt;/h3>
&lt;p>The Clusterpedia chart provides two storage components such as &lt;code>bitnami/postgresql&lt;/code> and &lt;code>bitnami/mysql&lt;/code> to choose from as sub-charts.&lt;/p>
&lt;p>&lt;code>postgresql&lt;/code> is the default storage component. IF you want to use MySQL, you can add &lt;code>--set postgresql.enabled=false --set mysql.enabled=true&lt;/code> in the subsequent installation command.&lt;/p>
&lt;p>For specific configuration about storage components, see &lt;a href="https://github.com/bitnami/charts/tree/master/bitnami/postgresql">bitnami/postgresql&lt;/a> and &lt;a href="https://github.com/bitnami/charts/tree/master/bitnami/mysql">bitnami/mysql&lt;/a>.&lt;/p>
&lt;p>&lt;strong>You can also choose not to install any storage component, but use external components. For related settings, see charts/values.yaml&lt;/strong>&lt;/p>
&lt;!--
### é€‰æ‹© CRD çš„å®‰è£…/ç®¡ç†æ–¹å¼
clusterpedia è¦æ±‚çŽ¯å¢ƒä¸­åˆ›å»ºç›¸åº”çš„ CRD èµ„æºï¼Œå¯ä»¥é€‰æ‹©æ‰‹åŠ¨éƒ¨ç½² CRD YAMLï¼Œä¹Ÿå¯ä»¥åœ¨ Helm ä¸­ç®¡ç†ã€‚
#### æ‰‹åŠ¨ç®¡ç†
-->
&lt;h3 id="choose-a-installation-or-management-mode-for-crds">Choose a installation or management mode for CRDs&lt;/h3>
&lt;p>Clusterpedia requires proper CRD resources to be created in the retrieval environment. You can choose to manually deploy CRDs by using YAML, or you can manage it with Helm.&lt;/p>
&lt;h4 id="manage-manually">Manage manually&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">kubectl apply -f ./_crds
&lt;/code>&lt;/pre>&lt;/div>&lt;!--
#### ä½¿ç”¨ Helm ç®¡ç†
åœ¨åŽç»­å®‰è£…å‘½ä»¤ä¸­éœ€è¦æ‰‹åŠ¨æ·»åŠ  `--set installCRDs=true` å³å¯ã€‚
### å†³å®šæ˜¯å¦éœ€è¦åˆ›å»º Local PV
Clusterpedia Chart å¯ä»¥ä¸ºç”¨æˆ·åˆ›å»ºå­˜å‚¨ç»„ä»¶ä½¿ç”¨ Local PVã€‚
**ç”¨æˆ·åœ¨å®‰è£…æ—¶éœ€è¦é€šè¿‡ `--set persistenceMatchNode=&lt;selected node name>` æ¥æŒ‡å®š Local PV æ‰€åœ¨èŠ‚ç‚¹ã€‚**
å¦‚æžœç”¨æˆ·ä¸éœ€è¦åˆ›å»º Local PVï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨ `--set persistenceMatchNode=None` æ˜¾å¼å£°æ˜Žã€‚
## å®‰è£… Clusterpedia
ç»è¿‡ä¸Šè¿°å†³ç­–åŽï¼Œç”¨æˆ·å¯ä»¥è¿›è¡Œå®‰è£…ï¼š
-->
&lt;h4 id="manage-with-helm">Manage with Helm&lt;/h4>
&lt;p>Manually add &lt;code>--set installCRDs=true&lt;/code> in the subsequent installation command.&lt;/p>
&lt;h3 id="check-if-you-need-to-create-a-local-pv">Check if you need to create a local PV&lt;/h3>
&lt;p>Through the Clusterpedia chart, you can create storage components to use a local PV.&lt;/p>
&lt;p>&lt;strong>You need to specify the node where the local PV is located through &lt;code>--set persistenceMatchNode=&amp;lt;selected node name&amp;gt;&lt;/code> during installation.&lt;/strong>&lt;/p>
&lt;p>If you need not to create the local PV, you can use &lt;code>--set persistenceMatchNode=None&lt;/code> to declare it explicitly.&lt;/p>
&lt;h2 id="install-clusterpedia">Install Clusterpedia&lt;/h2>
&lt;p>After the above procedure is completed, you can run the following command to install Clusterpedia:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">helm install clusterpedia . &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span>--namespace clusterpedia-system &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span>--create-namespace &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span>--set &lt;span style="color:#000">persistenceMatchNode&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">={{&lt;/span> LOCAL_PV_NODE &lt;span style="color:#ce5c00;font-weight:bold">}}&lt;/span> &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span>--set &lt;span style="color:#000">installCRDs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#204a87">true&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;!--
## å¸è½½ Clusterpedia
åœ¨å¸è½½ Clusterpedia å‰éœ€è¦æ‰‹åŠ¨æ¸…ç†æ‰€æœ‰ `PediaCluster` èµ„æºã€‚
-->
&lt;h2 id="uninstall-clusterpedia">Uninstall Clusterpedia&lt;/h2>
&lt;p>Before uninstallation, you shall manually clear all &lt;code>PediaCluster&lt;/code> resources.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">kubectl get pediacluster
&lt;/code>&lt;/pre>&lt;/div>&lt;!--`PediaCluster` æ¸…ç†å®ŒæˆåŽå°±å¯ä»¥æ‰§è¡Œå¸è½½å‘½ä»¤ã€‚-->
&lt;p>You can run the command to uninstall it after the &lt;code>PediaCluster&lt;/code> resources are cleared.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">helm -n clusterpedia-system uninstall clusterpedia
&lt;/code>&lt;/pre>&lt;/div>&lt;!--å¦‚æžœç”¨æˆ·ä½¿ç”¨æ‰‹åŠ¨åˆ›å»ºçš„ CRD èµ„æºï¼Œé‚£ä¹ˆåŒæ ·ä¹Ÿéœ€è¦æ‰‹åŠ¨æ¸…ç† CRDã€‚-->
&lt;p>If you use any CRD resource that is manually created, you also need to manually clear the CRDs.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">kubectl delete -f ./_crds
&lt;/code>&lt;/pre>&lt;/div>&lt;!--
**æ³¨æ„ PVC å’Œ PV å¹¶ä¸ä¼šåˆ é™¤ï¼Œç”¨æˆ·éœ€è¦æ‰‹åŠ¨åˆ é™¤ã€‚**
å¦‚æžœåˆ›å»ºäº† Local PVï¼Œé‚£ä¹ˆè¿˜éœ€è¦è¿›å…¥ç›¸åº”èŠ‚ç‚¹ï¼Œæ¸…ç† Local PV çš„é—ç•™æ•°æ®ã€‚
-->
&lt;p>&lt;strong>Note that PVC and PV will not be deleted. You need to manually delete them.&lt;/strong>&lt;/p>
&lt;p>If you created a local PV, you need log in to the node and remove all remained data about the local PV.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># Log in to the node with Local PV&lt;/span>
rm /var/local/clusterpedia/internalstorage/&amp;lt;storage type&amp;gt;
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Blog: Clusterpedia Awarded | One of IT Technology Influcence Stars Selected by CSDN</title><link>/blog/2022/04/01/clusterpedia-awarded-one-of-it-technology-influcence-stars-selected-by-csdn/</link><pubDate>Fri, 01 Apr 2022 00:00:00 +0000</pubDate><guid>/blog/2022/04/01/clusterpedia-awarded-one-of-it-technology-influcence-stars-selected-by-csdn/</guid><description>
&lt;div align="center">&lt;img src="http://blog.daocloud.io/wp-content/uploads/d807bc86a68e6e3bd67c041e86e611e0.jpg" style="width:900px;" />&lt;/div>
&lt;hr>
&lt;!--
3 æœˆ 30 æ—¥ï¼ŒCSDN æ­£å¼å…¬å¸ƒ IT æŠ€æœ¯å½±å“åŠ›ä¹‹æ˜Ÿè¯„é€‰ç»“æžœï¼ŒClusterpedia å…¥é€‰ã€Œ2021 å¹´åº¦äº‘åŽŸç”ŸæŠ€æœ¯äº§å“ã€ã€‚
-->
&lt;p>On March 30, CSDN officially announced the selection list of IT technology influence stars, and Clusterpedia was selected as a &amp;ldquo;Cloud Native Technology Product in 2021&amp;rdquo;.&lt;/p>
&lt;!--
åœ¨å¤šäº‘æ—¶ä»£ï¼Œå¤šé›†ç¾¤å†…éƒ¨èµ„æºç®¡ç†å’Œæ£€ç´¢è¶Šæ¥è¶Šå¤æ‚ï¼Œæˆä¸ºå¤šäº‘ç®¡ç†çš„ä¸€å¤§éš¾é¢˜ã€‚
-->
&lt;p>In the multi-cloud era, it is more and more complex and becomes a problem for resource management and retrieval in a multi-cluster environment.&lt;/p>
&lt;!--
åœ¨å•é›†ç¾¤ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ kubectl æ¥æŸ¥çœ‹èµ„æºï¼Œæˆ–è€…ç›´æŽ¥è®¿é—® Kubernetes çš„ OpenAPIï¼Œåœ¨ä»£ç ä¸­ä¹Ÿå¯ä»¥å€ŸåŠ© client-go æ¥å¯¹èµ„æºè¿›è¡Œæ£€ç´¢ã€‚
-->
&lt;p>In a single cluster, we usually use kubectl to view resources, directly access Kubernetes OpenAPI, or use client-go to retrieve resources in the code.&lt;/p>
&lt;!--
è€Œåœ¨å¤šé›†ç¾¤çŽ¯å¢ƒä¸‹ï¼ŒClusterpedia é€šè¿‡å…¼å®¹ Kubernetes OpenAPI ï¼Œç”¨æˆ·å¯ä»¥ä¾ç„¶ä½¿ç”¨å•é›†ç¾¤çš„æ–¹å¼ï¼Œæ¥å¯¹å¤šé›†ç¾¤èµ„æºè¿›è¡Œå¤æ‚æ£€ç´¢ï¼Œæ— éœ€ä»Žæ¯ä¸ªé›†ç¾¤ä¸­æ‹‰å–æ•°æ®åˆ°æœ¬åœ°è¿›è¡Œè¿‡æ»¤ã€‚
-->
&lt;p>Now, in a multi-cluster environment, Clusterpedia provides compatibility with Kubernetes OpenAPI, so you can still perform complex retrieval or search for multi-cluster resources like a single cluster without pulling data from each cluster to the local for filtering.&lt;/p>
&lt;div align="center">&lt;img src="https://p3.toutiaoimg.com/origin/tos-cn-i-qvj2lq49k0/ad3f106d991a45acbbdfe067425def26" style="width:300px;" />&lt;/div></description></item><item><title>Blog: Demo Video ï½œClusterpedia - Complex Retrieval of Resources in a Multi-Cloud Environment</title><link>/blog/2022/03/01/demo-video-clusterpedia-complex-retrieval-of-resources-in-a-multi-cloud-environment/</link><pubDate>Tue, 01 Mar 2022 00:00:00 +0000</pubDate><guid>/blog/2022/03/01/demo-video-clusterpedia-complex-retrieval-of-resources-in-a-multi-cloud-environment/</guid><description>
&lt;!--
Clusterpedia çš„å‘èµ·äºº --ã€ŒDaocloud é“å®¢ã€çš„äº‘åŽŸç”Ÿç ”å‘å·¥ç¨‹å¸ˆè”¡å¨ï¼Œä¸ºå¤§å®¶è¯¦ç»†ä»‹ç» Clusterpedia åœ¨èµ„æºæ£€ç´¢ä¸Šæä¾›çš„åŠŸèƒ½ï¼Œè®©å¤§å®¶å¯ä»¥ç›´è§‚çš„äº†è§£åˆ°ä½¿ç”¨ Clusterepdia å¯ä»¥è§£å†³å“ªäº›é—®é¢˜ã€‚
-->
&lt;p>Iceber, the sponsor of Clusterpedia and a cloud native senior engineer of Daocloud, introduced the functions provided by Clusterpedia about resource retrieval in detail. This video step-by-step demonstrated what issues can be solved by using Clusterepdia.&lt;/p>
&lt;div align="center">&lt;a href="https://www.bilibili.com/video/BV1qi4y117Vq">&lt;img class="aligncenter wp-image-7957 size-full" src="http://blog.daocloud.io/wp-content/uploads/clusterpedia.png" alt="" width="800" height="500" data-tag="bdshare">&lt;/a>&lt;/div>
&lt;!--
## Clusterpedia å¤šé›†ç¾¤èµ„æºæ£€ç´¢ç¥žå™¨
éšç€äº‘åŽŸç”ŸæŠ€æœ¯çš„å‘å±•ã€æ‰¿è½½ä¸šåŠ¡é‡çš„å¢žåŠ ä»¥åŠé›†ç¾¤è§„æ¨¡çš„ä¸æ–­æ‰©å¤§ï¼Œå•ä¸ª Kubernetes é›†ç¾¤å·²ç»æ— æ³•æ»¡è¶³å¾ˆå¤šä¼ä¸šçš„éœ€æ±‚ï¼Œæˆ‘ä»¬åœ¨é€æ¸çš„æ­¥å…¥å¤šäº‘æ—¶ä»£ï¼Œå¤šé›†ç¾¤å†…éƒ¨èµ„æºç®¡ç†å’Œæ£€ç´¢å˜å¾—è¶Šå‘å¤æ‚å’Œå›°éš¾ã€‚
ç”±æ­¤ï¼Œç¤¾åŒºä¸æ–­å‡ºçŽ°äº†å¾ˆå¤šä¼˜ç§€çš„çš„å¼€æºé¡¹ç›®ï¼Œä¾‹å¦‚ç”¨äºŽé›†ç¾¤ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„ cluster apiï¼Œä»¥åŠå¤šäº‘åº”ç”¨ç®¡ç†çš„ karmadaï¼Œ clusternet ç­‰ã€‚è€Œ Clusterpedia ä¾¿æ˜¯å»ºç«‹åœ¨è¿™äº›äº‘ç®¡å¹³å°ä¹‹ä¸Šï¼Œä¸ºç”¨æˆ·æä¾›å¤šé›†ç¾¤èµ„æºçš„å¤æ‚æ£€ç´¢ã€‚
åœ¨å•é›†ç¾¤ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ kubectl æ¥æŸ¥çœ‹èµ„æºï¼Œæˆ–è€…ç›´æŽ¥è®¿é—® Kubernetes çš„ OpenAPIï¼Œåœ¨ä»£ç ä¸­ä¹Ÿå¯ä»¥å€ŸåŠ© client-go æ¥å¯¹èµ„æºè¿›è¡Œæ£€ç´¢ã€‚
è€Œåœ¨å¤šé›†ç¾¤çŽ¯å¢ƒä¸‹ï¼ŒClusterpedia é€šè¿‡å…¼å®¹ Kubernetes OpenAPI ï¼Œç”¨æˆ·å¯ä»¥ä¾ç„¶ä½¿ç”¨å•é›†ç¾¤çš„æ–¹å¼ï¼Œæ¥å¯¹å¤šé›†ç¾¤èµ„æºè¿›è¡Œå¤æ‚æ£€ç´¢ï¼Œæ— éœ€ä»Žæ¯ä¸ªé›†ç¾¤ä¸­æ‹‰å–æ•°æ®åˆ°æœ¬åœ°è¿›è¡Œè¿‡æ»¤ã€‚
å½“ç„¶ Clusterpedia çš„èƒ½åŠ›å¹¶ä¸ä»…ä»…åªæ˜¯æ£€ç´¢æŸ¥çœ‹ï¼Œæœªæ¥è¿˜ä¼šæ”¯æŒå¯¹èµ„æºçš„ç®€å•æŽ§åˆ¶ï¼Œå°±åƒ wiki åŒæ ·æ”¯æŒç¼–è¾‘è¯æ¡ä¸€æ ·ã€‚Clusterpedia å…·æœ‰è®¸å¤šç‰¹æ€§å’ŒåŠŸèƒ½ï¼š
-->
&lt;h2 id="clusterpedia-is-an-artifact-for-multi-cluster-resource-retrieval">Clusterpedia is an artifact for multi-cluster resource retrieval&lt;/h2>
&lt;p>With the increase of services you provide and the continuous expansion of the cluster scale, a single Kubernetes cluster may no longer meet the needs of many enterprises. As the cloud-native technologies develop, a multi-cloud era is coming. It is more complex and difficult to manage and retrieve resources in multiple clusters.&lt;/p>
&lt;p>As a result, many excellent open source projects have emerged in the community, such as cluster api for cluster lifecycle management, karmada and clusternet for multi-cloud application management. Clusterpedia is built on these cloud management platforms to provide you with complex search for multi-cluster resources.&lt;/p>
&lt;p>In a single cluster, we often use kubectl to view resources, directly access Kubernetes OpenAPI, or use client-go to retrieve resources in the code.&lt;/p>
&lt;p>Now, in a multi-cluster environment, Clusterpedia provides compatibility with Kubernetes OpenAPI, so you can still perform complex retrieval or search for multi-cluster resources like a single cluster without pulling data from each cluster to the local for filtering.&lt;/p>
&lt;p>In addition, the capabilities of Clusterpedia are not only for searching and viewing. It also supports simple control of resources in the future, just like wiki that also supports to edit entries. Clusterpedia provides the following features now:&lt;/p>
&lt;!--
* æ”¯æŒå¤æ‚çš„æ£€ç´¢æ¡ä»¶ï¼Œè¿‡æ»¤æ¡ä»¶ï¼ŒæŽ’åºï¼Œåˆ†é¡µç­‰ç­‰
* æ”¯æŒæŸ¥è¯¢èµ„æºæ—¶è¯·æ±‚é™„å¸¦å…³ç³»èµ„æº
* ç»Ÿä¸€ä¸»é›†ç¾¤å’Œå¤šé›†ç¾¤èµ„æºæ£€ç´¢å…¥å£
* å…¼å®¹ kubernetes OpenAPI, å¯ä»¥ç›´æŽ¥ä½¿ç”¨ kubectl è¿›è¡Œå¤šé›†ç¾¤æ£€ç´¢, è€Œæ— éœ€ç¬¬ä¸‰æ–¹æ’ä»¶æˆ–è€…å·¥å…·
* å…¼å®¹æ”¶é›†ä¸åŒç‰ˆæœ¬çš„é›†ç¾¤èµ„æºï¼Œä¸å—ä¸»é›†ç¾¤ç‰ˆæœ¬çº¦æŸï¼Œ
* èµ„æºæ”¶é›†é«˜æ€§èƒ½ï¼Œä½Žå†…å­˜
* æ ¹æ®é›†ç¾¤å½“å‰çš„å¥åº·çŠ¶æ€ï¼Œè‡ªåŠ¨å¯åœèµ„æºæ”¶é›†
* æ’ä»¶åŒ–å­˜å‚¨å±‚ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±éœ€æ±‚ä½¿ç”¨å…¶ä»–å­˜å‚¨ç»„ä»¶æ¥è‡ªå®šä¹‰å­˜å‚¨å±‚
* é«˜å¯ç”¨
-->
&lt;ul>
&lt;li>Support for search with complex conditions, filters, sorting, and paging&lt;/li>
&lt;li>Support for requesting attached resources when querying resources&lt;/li>
&lt;li>Use a unified retrieval portal for master cluster and multi-cluster resources&lt;/li>
&lt;li>Compatible with kubernetes OpenAPI, through which you can directly use kubectl for multi-cluster retrieval and need not any third-party plugins or tools&lt;/li>
&lt;li>Compatible with collecting different versions of cluster resources and not constrained by the version of master cluster&lt;/li>
&lt;li>High performance and low memory consumption in the process of resource collection&lt;/li>
&lt;li>Automatically start and stop resource collection based on to the health status of clusters&lt;/li>
&lt;li>Support for the pluggable storage layer that indicates you can use other storage components to customize the storage layer&lt;/li>
&lt;li>High availability&lt;/li>
&lt;/ul>
&lt;h2 id="whats-next">What&amp;rsquo;s Next&lt;/h2>
&lt;!--
é™¤äº†æ”¯æŒå¤šé›†ç¾¤çš„å¤æ‚æ£€ç´¢ï¼ŒClusterpedia è¿˜æœ‰å¾ˆå¤šå…¶ä»–ä¼˜ç‚¹ï¼Œä¾‹å¦‚é€šè¿‡èšåˆå¼ API æ¥ç»Ÿä¸€ä¸»é›†ç¾¤å’Œå¤šé›†ç¾¤èµ„æºçš„è®¿é—®å…¥å£ï¼Œåœ¨å®žæ—¶åŒæ­¥å­é›†ç¾¤èµ„æºæ—¶çš„ä½Žå†…å­˜å ç”¨ä»¥åŠå¼±ç½‘ä¼˜åŒ–ï¼Œå¦å¤–è¿˜æœ‰é€šè¿‡æ’ä»¶åŒ–å­˜å‚¨å±‚æ¥è§£è€¦å¯¹å­˜å‚¨ç»„ä»¶çš„ä¾èµ–ã€‚
ä¸‹ä¸€æœŸå°†ä¸ºå¤§å®¶ä»‹ç»å…·ä½“è®¾è®¡å’Œå®žçŽ°åŽŸç†ï¼Œè¯¦ç»†è§£è¯» Clusterpedia çš„ä¼˜ç‚¹ï¼Œæ•¬è¯·æœŸå¾…ã€‚
-->
&lt;p>In addition to supporting complex retrieval of multiple clusters, Clusterpedia can provide more benefits, such as a unified portal to the master cluster and multi-cluster resources through an aggregated API, low memory usage and weak network optimization when synchronizing sub-cluster resources in real time. It can also provide a pluggable storage layer to decouple the dependencies of storage components.&lt;/p>
&lt;p>In the next topic, we will introduce the specific design and implementation principles, and explain more benefits offered by Clusterpedia, so stay tuned.&lt;/p></description></item><item><title>Blog: Clusterpedia v0.1.0 Release â€” four important functions</title><link>/blog/2022/02/16/clusterpedia-v0.1.0-release-four-important-functions/</link><pubDate>Wed, 16 Feb 2022 00:00:00 +0000</pubDate><guid>/blog/2022/02/16/clusterpedia-v0.1.0-release-four-important-functions/</guid><description>
&lt;p>&lt;strong>This is the first release of&lt;/strong> &lt;a href="https://clusterpedia.io">&lt;strong>Clusterpedia&lt;/strong>&lt;/a> &lt;strong>ðŸ¥³ðŸ¥³ðŸ¥³, and it also means that it is officially in the iteration phase.&lt;/strong>&lt;/p>
&lt;p>Compared to the initial &lt;a href="https://github.com/clusterpedia-io/clusterpedia/tree/v0.0.8">v0.0.8&lt;/a> and &lt;a href="https://github.com/clusterpedia-io/clusterpedia/tree/v0.0.9-alpha">v0.0.9-alpha&lt;/a>, v0.1.0 add a lot of features and makes some incompatible updates.&lt;/p>
&lt;blockquote>
&lt;p>If upgrading from v0.0.9-alpha or v0.0.8, you can refer to &lt;a href="/blog/2022/02/15/upgrade-to-clusterpedia-0.1.0/">Upgrade to Clusterpedia 0.1.0&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h1 id="features-preview">Features Preview&lt;/h1>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:left">Role&lt;/th>
&lt;th style="text-align:left">Search Label Key&lt;/th>
&lt;th style="text-align:left">URL Query&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:left">Filter cluster names&lt;/td>
&lt;td style="text-align:left">&lt;code>search.clusterpedia.io/clusters&lt;/code>&lt;/td>
&lt;td style="text-align:left">&lt;code>clusters&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Filter namespaces&lt;/td>
&lt;td style="text-align:left">&lt;code>search.clusterpedia.io/namespaces&lt;/code>&lt;/td>
&lt;td style="text-align:left">&lt;code>namespaces&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Filter resource names&lt;/td>
&lt;td style="text-align:left">&lt;code>search.clusterpedia.io/names&lt;/code>&lt;/td>
&lt;td style="text-align:left">&lt;code>names&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Specified Owner UID&lt;/td>
&lt;td style="text-align:left">&lt;code>internalstorage.clusterpedia.io/owner-uid&lt;/code>&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Specified Owner Seniority&lt;/td>
&lt;td style="text-align:left">&lt;code>internalstorage.clusterpedia.io/owner-seniority&lt;/code>&lt;/td>
&lt;td style="text-align:left">&lt;code>ownerSeniority&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Order by fields&lt;/td>
&lt;td style="text-align:left">&lt;code>search.clusterpedia.io/orderby&lt;/code>&lt;/td>
&lt;td style="text-align:left">&lt;code>orderby&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Set page size&lt;/td>
&lt;td style="text-align:left">&lt;code>search.clusterpedia.io/size&lt;/code>&lt;/td>
&lt;td style="text-align:left">&lt;code>limit&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Set page offset&lt;/td>
&lt;td style="text-align:left">&lt;code>search.clusterpedia.io/offset&lt;/code>&lt;/td>
&lt;td style="text-align:left">&lt;code>continue&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Response include Continue&lt;/td>
&lt;td style="text-align:left">&lt;code>search.clusterpedia.io/with-continue&lt;/code>&lt;/td>
&lt;td style="text-align:left">&lt;code>withContinue&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Response include remaining count&lt;/td>
&lt;td style="text-align:left">&lt;code>search.clusterpedia.io/with-remaining-count&lt;/code>&lt;/td>
&lt;td style="text-align:left">&lt;code>withRemainingCount&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Native &lt;code>Label Selector&lt;/code> and enhanced &lt;code>Field Selector&lt;/code> supported in addition to search label.&lt;/p>
&lt;h1 id="important-features">Important Features&lt;/h1>
&lt;p>Let&amp;rsquo;s start with the more important features that have been added in 0.1.0&lt;/p>
&lt;ul>
&lt;li>The number of remaining items carried in response data&lt;/li>
&lt;li>Added warnning when searching for resources in a &lt;code>Not Ready&lt;/code> cluster&lt;/li>
&lt;li>Enhancements to the native FieldSelector&lt;/li>
&lt;li>Search by Parent or Ancestor Owner&lt;/li>
&lt;/ul>
&lt;h2 id="warnning-alert-on-resource-search">Warnning alert on resource search&lt;/h2>
&lt;p>When a cluster is not ready for some reason, resources are often not synchronised properly either.&lt;/p>
&lt;p>Warnning alerts are used to alert users of cluster exceptions when searching for resources within the cluster, and the resources searched may not be accurate in real time.&lt;/p>
&lt;pre>&lt;code>$ kubectl get pediacluster
NAME APISERVER VERSION STATUS
cluster-1 https://10.6.100.10:6443 v1.22.2 ClusterSynchroStop
$ kubectl --cluster cluster-1 get pods
Warning: cluster-1 is not ready and the resources obtained may be inaccurate, reason: ClusterSynchroStop
CLUSTER NAME READY STATUS RESTARTS AGE
cluster-1 fake-pod-698dfbbd5b-64fsx 1/1 Running 0 68d
cluster-1 fake-pod-698dfbbd5b-9ftzh 1/1 Running 0 39d
cluster-1 fake-pod-698dfbbd5b-rk74p 1/1 Running 0 39d
cluster-1 quickstart-ingress-nginx-admission-create--1-kxlnn 0/1 Completed 0 126d
&lt;/code>&lt;/pre>
&lt;h2 id="field-selector">Field Selector&lt;/h2>
&lt;p>Native Kubernetes currently only supports field filtering on &lt;code>metadata.name&lt;/code> and &lt;code>metadata.namespace&lt;/code>, and the operators only support =, !=, ==`, which is very limited.&lt;/p>
&lt;p>Although some specific resources will support some special fields, the use is still rather limited&lt;/p>
&lt;pre>&lt;code># kubernetes/pkg
$ grep AddFieldLabelConversionFunc . -r
./apis/core/v1/conversion.go: err := scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;Pod&amp;quot;),
./apis/core/v1/conversion.go: err = scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;Node&amp;quot;),
./apis/core/v1/conversion.go: err = scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;ReplicationController&amp;quot;),
./apis/core/v1/conversion.go: return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;Event&amp;quot;),
./apis/core/v1/conversion.go: return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;Namespace&amp;quot;),
./apis/core/v1/conversion.go: return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;Secret&amp;quot;),
./apis/certificates/v1/conversion.go: return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;CertificateSigningRequest&amp;quot;),
./apis/certificates/v1beta1/conversion.go: return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;CertificateSigningRequest&amp;quot;),
./apis/batch/v1/conversion.go: return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;Job&amp;quot;),
./apis/batch/v1beta1/conversion.go: err = scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(kind),
./apis/events/v1/conversion.go: return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;Event&amp;quot;),
./apis/events/v1beta1/conversion.go: return scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;Event&amp;quot;),
./apis/apps/v1beta2/conversion.go: if err := scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;StatefulSet&amp;quot;),
./apis/apps/v1beta1/conversion.go: if err := scheme.AddFieldLabelConversionFunc(SchemeGroupVersion.WithKind(&amp;quot;StatefulSet&amp;quot;),
&lt;/code>&lt;/pre>
&lt;p>Clusterpedia provides more powerful features based on the compatibility with existing Field Selector features, and supports the same operators as Label Selector: &lt;code>!&lt;/code>, &lt;code>=&lt;/code>, &lt;code>!=&lt;/code>, &lt;code>==&lt;/code>, &lt;code>in&lt;/code>, &lt;code>notin&lt;/code>.&lt;/p>
&lt;p>For example, we can filter by annotations, like label selector&lt;/p>
&lt;pre>&lt;code>kubectl get deploy --field-selector=&amp;quot;metadata.annotations['test.io'] in (value1, value2)&amp;quot;
&lt;/code>&lt;/pre>
&lt;p>&lt;a href="https://clusterpedia.io/docs/usage/search/multi-cluster/#field-selector">Lean More&lt;/a>&lt;/p>
&lt;h2 id="search-by-parent-or-ancestor-owner">Search by Parent or Ancestor Owner&lt;/h2>
&lt;p>There will usually be an Owner relationship between Kubernetes resources.&lt;/p>
&lt;pre>&lt;code>apiVersion: v1
kind: Pod
metadata:
ownerReferences:
- apiVersion: apps/v1
blockOwnerDeletion: true
controller: true
kind: ReplicaSet
name: fake-pod-698dfbbd5b
uid: d5bf2bdd-47d2-4932-84fb-98bde486d244
&lt;/code>&lt;/pre>
&lt;p>Searching by Owner is a very useful search function, and Clusterpedia also supports the seniority advancement of Owner to search for grandparents and even higher seniority.&lt;/p>
&lt;p>By searching by Owner, we can query all Pods under Deployment at once, without having to query ReplicaSet in between&lt;/p>
&lt;blockquote>
&lt;p>Currently only supports query by Owner UID. The feature of using Owner Name for queries is still under discussion, we can join the discussion in the &lt;a href="https://github.com/clusterpedia-io/clusterpedia/issues/49">issue: Support for searching resources by owner&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;pre>&lt;code>$ DEPLOY_UID=$(kubectl --cluster cluster-1 get deploy fake-deploy -o jsonpath=&amp;quot;{.metadata.uid}&amp;quot;)
$ kubectl --cluster cluster-1 get pods -l \
&amp;quot;internalstorage.clusterpedia.io/owner-uid=$DEPLOY_UID,\
internalstorage.clusterpedia.io/owner-seniority=1&amp;quot;
&lt;/code>&lt;/pre>
&lt;p>&lt;a href="https://clusterpedia.io/docs/usage/search/multi-cluster/#search-by-parent-or-ancestor-owner">Lean More&lt;/a>&lt;/p>
&lt;h2 id="the-number-of-remaining-items-carried-in-response-data">The number of remaining items carried in response data&lt;/h2>
&lt;p>&lt;strong>In some UI cases, it is often necessary to get the total number of resources in the current search condition.&lt;/strong>&lt;/p>
&lt;p>The RemainingItemCount field exists in the &lt;a href="https://pkg.go.dev/k8s.io/apimachinery/pkg/apis/meta/v1#ListMeta">ListMeta&lt;/a> of the Kubernetes List response.&lt;/p>
&lt;pre>&lt;code>type ListMeta struct {
...
// remainingItemCount is the number of subsequent items in the list which are not included in this
// list response. If the list request contained label or field selectors, then the number of
// remaining items is unknown and the field will be left unset and omitted during serialization.
// If the list is complete (either because it is not chunking or because this is the last chunk),
// then there are no more remaining items and this field will be left unset and omitted during
// serialization.
// Servers older than v1.15 do not set this field.
// The intended use of the remainingItemCount is *estimating* the size of a collection. Clients
// should not rely on the remainingItemCount to be set or to be exact.
// +optional
RemainingItemCount *int64 `json:&amp;quot;remainingItemCount,omitempty&amp;quot; protobuf:&amp;quot;bytes,4,opt,name=remainingItemCount&amp;quot;`
}
&lt;/code>&lt;/pre>
&lt;p>By reusing this field, the total number of resources can be returned in a Kubernetes OpenAPI-compatible manner:&lt;/p>
&lt;p>&lt;strong>offset + len(list.items) + list.metadata.remainingItemCount&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>Use with Paging&lt;/p>
&lt;/blockquote>
&lt;pre>&lt;code>$ kubectl get --raw=&amp;quot;/apis/clusterpedia.io/v1beta1/resources/apis/apps/v1/deployments?withRemainingCount&amp;amp;limit=1&amp;quot; | jq
{
&amp;quot;kind&amp;quot;: &amp;quot;DeploymentList&amp;quot;,
&amp;quot;apiVersion&amp;quot;: &amp;quot;apps/v1&amp;quot;,
&amp;quot;metadata&amp;quot;: {
&amp;quot;remainingItemCount&amp;quot;: 23
},
&amp;quot;items&amp;quot;: [
...
]
}
&lt;/code>&lt;/pre>
&lt;p>&lt;a href="https://clusterpedia.io/docs/usage/search/multi-cluster/#response-with-remaining-count">Lean More&lt;/a>&lt;/p>
&lt;h1 id="realease-v010httpsgithubcomclusterpedia-ioclusterpediareleasestagv010">&lt;a href="https://github.com/clusterpedia-io/clusterpedia/releases/tag/v0.1.0">Realease v0.1.0&lt;/a>&lt;/h1></description></item><item><title>Blog: Upgrade to Clusterpedia 0.1.0</title><link>/blog/2022/02/15/upgrade-to-clusterpedia-0.1.0/</link><pubDate>Tue, 15 Feb 2022 00:00:00 +0000</pubDate><guid>/blog/2022/02/15/upgrade-to-clusterpedia-0.1.0/</guid><description>
&lt;p>With the release of Clusterpedia 0.1.0, we can now update the earlier 0.0.9-alpha or 0.0.8 to 0.1.0&lt;/p>
&lt;h2 id="clean-resources">Clean Resources&lt;/h2>
&lt;p>Since the url path to search resources has been modified(&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/73">#73&lt;/a>), we need to use &lt;a href="https://github.com/clusterpedia-io/clusterpedia/blob/v0.0.9-alpha/hack/clean-clusterconfigs.sh">cealn-clusterconfigs.sh&lt;/a> in 0.0.9-alpha to clean up the cluster shortcut in the &lt;em>.kube/config&lt;/em>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -sfL https://raw.githubusercontent.com/clusterpedia-io/clusterpedia/v0.0.9-alpha/hack/clean-clusterconfigs.sh &lt;span style="color:#000;font-weight:bold">|&lt;/span> sh -
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Backup and delete the &lt;code>PediaCluster&lt;/code> resources.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">kubectl get pediacluster -o yaml &amp;gt; clusters.yaml.bak
kubectl delete pediacluster --all
&lt;/code>&lt;/pre>&lt;/div>&lt;p>After all &lt;code>PediaCluster&lt;/code> resources have been deleted, remove the &lt;code>PediaCluster CRD&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">kubectl delete crd pediaclusters.clusters.clusterpedia.io
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Remove the &lt;code>APIServices&lt;/code> used to register the Aggregated API&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">kubectl delete apiservices v1alpha1.pedia.clusterpedia.io
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="upgrade-clusterpedia">Upgrade Clusterpedia&lt;/h2>
&lt;p>Create &lt;code>PediaCluster CRD&lt;/code>, and upgrade &lt;code>Clusterpedia APIServer&lt;/code> and &lt;code>Clustersynchro Manager&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#000">DEPLOY_YAML_PATH&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>https://raw.githubusercontent.com/clusterpedia-io/clusterpedia/v0.1.0/deploy
&lt;span style="color:#000">CRD_YAML_PATH&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000">$DEPLOY_YAML_PATH&lt;/span>/crds
kubectl apply -f &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> &lt;span style="color:#000">$CRD_YAML_PATH&lt;/span>/cluster.clusterpedia.io_pediaclusters.yaml,&lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> &lt;span style="color:#000">$DEPLOY_YAML_PATH&lt;/span>/clusterpedia_clustersynchro_manager_deployment.yaml,&lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> &lt;span style="color:#000">$DEPLOY_YAML_PATH&lt;/span>/clusterpedia_apiserver_deployment.yaml,&lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> &lt;span style="color:#000">$DEPLOY_YAML_PATH&lt;/span>/clusterpedia_apiserver_apiservice.yaml
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can also download the YAML locally, or pull the &lt;a href="https://github.com/clusterpedia-io/clusterpedia">clusterpedia&lt;/a> locally and go to &lt;em>./deploy&lt;/em> directory and run &lt;code>kubectl apply&lt;/code>&lt;/p>
&lt;h2 id="re-import-the-clusters">Re-import the clusters&lt;/h2>
&lt;p>Since the APIVersion and schema of &lt;code>PediaCluster&lt;/code> have been optimized for incompatibility,
it it necessary to recreate &lt;code>PediaCluster&lt;/code> based on the backed up &lt;em>clusters.yaml.bak&lt;/em>.&lt;/p>
&lt;p>The current example of &lt;code>PediaCluster&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">cluster.clusterpedia.io/v1alpha2&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">PediaCluster&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">cluster-example&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">apiserver&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;https://10.30.43.43:6443&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">caData&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">tokenData&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">certData&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">keyData&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">syncResources&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">group&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">apps&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">resources&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#000">deployments&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">group&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">resources&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#000">pods&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>There are three main changes compared to 0.0.9-alpha:&lt;/p>
&lt;ul>
&lt;li>&lt;code>apiVersion&lt;/code>: &lt;em>clusters.clusterpedia.io/v1alpha1&lt;/em> -&amp;gt; &lt;em>cluster.clusterpedia.io/v1alpha2&lt;/em>&lt;/li>
&lt;li>&lt;code>spec.apiserverURL&lt;/code> -&amp;gt; &lt;code>spec.apiserver&lt;/code>&lt;/li>
&lt;li>&lt;code>spec.resources&lt;/code> -&amp;gt; &lt;code>spec.syncResources&lt;/code>&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>The specific changes can be viewed: &lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/70">#70&lt;/a>
&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/67">#67&lt;/a>
&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/76">#76&lt;/a>
&lt;a href="https://github.com/clusterpedia-io/clusterpedia/pull/77">#77&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>Create new pediaclusters based on the old pediaclusters in &lt;em>clusters.yaml.bak&lt;/em>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">cluster.clusterpedia.io/v1alpha2&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">PediaCluster&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">cluster-1&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>{}&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000">---&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">cluster.clusterpedia.io/v1alpha2&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">PediaCluster&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">cluster-2&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>{}&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>View clusters status&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">kubectl get pediacluster
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Configure the cluster shortcut for kubectl&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -sfL https://raw.githubusercontent.com/clusterpedia-io/clusterpedia/v0.1.0/hack/gen-clusterconfigs.sh &lt;span style="color:#000;font-weight:bold">|&lt;/span> sh -
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Blog: Clusterpedia with kubectl support to retrieve multicluster resources</title><link>/blog/2021/12/03/clusterpedia-with-kubectl-support-to-retrieve-multicluster-resources/</link><pubDate>Fri, 03 Dec 2021 00:00:00 +0000</pubDate><guid>/blog/2021/12/03/clusterpedia-with-kubectl-support-to-retrieve-multicluster-resources/</guid><description>
&lt;p>This name Clusterpedia is inspired by Wikipedia. It is an encyclopedia of multi-cluster to synchronize, search for, and simply control multi-cluster resources. Clusterpedia can synchronize resources with multiple clusters and provide more powerful search features on the basis of compatibility with Kubernetes OpenAPI to help you effectively get any multi-cluster resource that you are looking for in a quick and easy way.&lt;/p>
&lt;blockquote>
&lt;p>The capability of Clusterpedia is not only to search for and view but also simply control resources in the future, just like Wikipedia that supports for editing entries.&lt;/p>
&lt;/blockquote>
&lt;h2 id="architecture-span-iddesignspan">Architecture &lt;span id="design">&lt;/span>&lt;/h2>
&lt;p>The architecture diagram of Clusterpedia is as follows:&lt;/p>
&lt;div align="center">&lt;img src="https://github.com/clusterpedia-io/clusterpedia/blob/main/docs/images/arch.png?raw=true" style="width:900px;" />&lt;/div>
The architecture consists of four parts:
&lt;ul>
&lt;li>&lt;strong>Clusterpedia APIServer&lt;/strong>: Register to Kube APIServer by the means of Aggregated API and provide services through a unified entrance&lt;/li>
&lt;li>&lt;strong>ClusterSynchro Manager&lt;/strong>: Manage the Cluster Synchro that is used to synchronize cluster resources&lt;/li>
&lt;li>&lt;strong>Storage Layer&lt;/strong>: Connect with a specific storage component and then register to Clusterpedia APIServer and ClusterSynchro Manager via a storage interface&lt;/li>
&lt;li>&lt;strong>Storage component&lt;/strong>: A specific storage facility such as MySQL, postgres, redis or other graph databases&lt;/li>
&lt;/ul>
&lt;p>In addition, Clusterpedia will use the custom resource &lt;em>PediaCluster&lt;/em> to implement cluster authentication and synchronize the resource configuration.&lt;/p>
&lt;p>Clusterpedia also provides a default storage layer that can connect with MySQL and postgres.&lt;/p>
&lt;blockquote>
&lt;p>Clusterpedia does not care about the specific storage settings used by users,
you can choose or implement the storage layer according to your own needs and then register the storage layer in Clusterpedia as a plug-in&lt;/p>
&lt;/blockquote>
&lt;h3 id="featuresspan-idfeaturesspan">Features&lt;span id="features">&lt;/span>&lt;/h3>
&lt;ul>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Support for complex search, filters, sorting, paging, and more&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Support for requesting relevant resources when you query resources&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Unify the search entry for master clusters and multi-cluster resources&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Compatible with kubernetes OpenAPI, where you can directly use kubectl for multi-cluster search without any third-party plug-ins or tools&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Compatible with synchronizing different versions of cluster resources, not restricted by the version of master cluster&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> High performance and low memory consumption for resource synchronization&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Automatically start/stop resource synchronization according to the current health status of the cluster
-&lt;input disabled="" type="checkbox"> Support for plug-in storage layer. You can use other storage components to customize the storage layer according to your needs.&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> High availability&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>The above unimplemented features are already in the &lt;a href="#roadmap">Roadmap&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h2 id="deploymentspan-iddeploymentspan">Deployment&lt;span id="deployment">&lt;/span>&lt;/h2>
&lt;p>For details on the deployment process, see &lt;a href="/docs/installation">Instaling Clusterpedia&lt;/a>, which highlights how to use clusterpedia.&lt;/p>
&lt;h2 id="synchronize-cluster-resourcesspan-idgetspan">Synchronize cluster resources&lt;span id="get">&lt;/span>&lt;/h2>
&lt;p>After deploying clusterpedia crds, you can use kubectl to operate &lt;em>PediaCluster&lt;/em> resources.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl get pediaclusters
&lt;/code>&lt;/pre>&lt;/div>&lt;p>In the examples directory, you can check examples of &lt;em>PediaCluster&lt;/em>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">clusters.clusterpedia.io/v1alpha1&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">PediaCluster&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">cluster-example&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">apiserverURL&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;https://10.30.43.43:6443&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">caData&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">tokenData&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">certData&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">keyData&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">resources&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">group&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">apps&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">resources&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#000">deployments&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">group&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">resources&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#000">pods&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The configuration of &lt;em>PediaCluster&lt;/em> can be divided into two parts:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Cluster authentication&lt;/strong>&lt;/li>
&lt;li>&lt;strong>Synchronize a specific resource &lt;code>.spec.resources&lt;/code>&lt;/strong>&lt;/li>
&lt;/ul>
&lt;h3 id="cluster-authentication">Cluster authentication&lt;/h3>
&lt;p>The fields of &lt;code>caData&lt;/code>, &lt;code>tokenData&lt;/code>, &lt;code>certData&lt;/code>, and &lt;code>keyData&lt;/code> can be used for cluster verification.&lt;/p>
&lt;blockquote>
&lt;p>Currently it does not support for getting the relevant verification information from ConfigMap or Secret.
However, the information is already in the &lt;a href="#roadmap">Roadmap&lt;/a>.&lt;/p>
&lt;/blockquote>
&lt;p>When setting the verification field, you shall use the strings encoded by base64.&lt;/p>
&lt;p>The &lt;code>. /examples&lt;/code> directory provides the rbac yaml &lt;code>clusterpedia_synchro_rbac.yaml&lt;/code>, which can be used to easily obtain the permission token for a subcluster.&lt;/p>
&lt;p>Deploy the yaml in the subcluster and get the proper token and CA certificate.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ &lt;span style="color:#8f5902;font-style:italic"># Switch to the sub-cluster to create rbac related resources&lt;/span>
$ kubectl apply -f examples/clusterpedia_synchro_rbac.yaml
$ &lt;span style="color:#000">SYNCHRO_TOKEN&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>kubectl get secret &lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>kubectl get serviceaccount clusterpedia-synchro -o &lt;span style="color:#000">jsonpath&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;{.secrets[0].name}&amp;#39;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">)&lt;/span> -o &lt;span style="color:#000">jsonpath&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;{.data.token}&amp;#39;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">)&lt;/span>
$ &lt;span style="color:#000">SYNCHRO_CA&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>kubectl get secret &lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>kubectl get serviceaccount clusterpedia-synchro -o &lt;span style="color:#000">jsonpath&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;{.secrets[0].name}&amp;#39;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">)&lt;/span> -o &lt;span style="color:#000">jsonpath&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;{.data.ca\.crt}&amp;#39;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Copy &lt;em>./examples/pediacluster.yaml&lt;/em>, modify &lt;code>.spec.apiserverURL&lt;/code> and &lt;code>.metadata.name&lt;/code> fields, and fill &lt;code>$SYNCHRO_TOKEN&lt;/code> and &lt;code>$SYNCHRO_CA&lt;/code> into &lt;code>tokenData&lt;/code> and &lt;code>caData&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl apply -f cluster-1.yaml
pediacluster.clusters.clusterpedia.io/cluster-1 created
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="synchronize-resources">Synchronize resources&lt;/h3>
&lt;p>You can specify the synchronized resources by setting &lt;code>group&lt;/code> in the &lt;code>spec.resources&lt;/code> field and the &lt;code>resources&lt;/code> section under &lt;code>group&lt;/code>.&lt;/p>
&lt;p>You can also view the resource synchronization status in the &lt;code>status&lt;/code> section:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">status:
conditions:
- lastTransitionTime: &lt;span style="color:#4e9a06">&amp;#34;2021-12-02T04:00:45Z&amp;#34;&lt;/span>
message: &lt;span style="color:#4e9a06">&amp;#34;&amp;#34;&lt;/span>
reason: Healthy
status: &lt;span style="color:#4e9a06">&amp;#34;True&amp;#34;&lt;/span>
type: Ready
resources:
- group: &lt;span style="color:#4e9a06">&amp;#34;&amp;#34;&lt;/span>
resources:
- kind: Pod
namespaced: &lt;span style="color:#204a87">true&lt;/span>
resource: pods
syncConditions:
- lastTransitionTime: &lt;span style="color:#4e9a06">&amp;#34;2021-12-02T04:00:45Z&amp;#34;&lt;/span>
status: Syncing
storageVersion: v1
version: v1
- group: apps
resources:
- kind: Deployment
namespaced: &lt;span style="color:#204a87">true&lt;/span>
resource: deployments
syncConditions:
- lastTransitionTime: &lt;span style="color:#4e9a06">&amp;#34;2021-12-02T04:00:45Z&amp;#34;&lt;/span>
status: Syncing
storageVersion: v1
version: v1
version: v1.22.2
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="search-for-resourcesspan-idviewspan">Search for resources&lt;span id="view">&lt;/span>&lt;/h2>
&lt;p>After configuring the resources to be synchronized, you can search for the cluster resources. Clusterpedia supports two types of resource search:&lt;/p>
&lt;ul>
&lt;li>Search for resources that are compatible with Kubernetes OpenAPI&lt;/li>
&lt;li>Search for &lt;code>Collection Resource&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl api-resources &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep pedia.clusterpedia.io
collectionresources pedia.clusterpedia.io/v1alpha1 &lt;span style="color:#204a87">false&lt;/span> CollectionResource
resources pedia.clusterpedia.io/v1alpha1 &lt;span style="color:#204a87">false&lt;/span> Resources
&lt;/code>&lt;/pre>&lt;/div>&lt;p>In order to facilitate and well use kubectl for searching, you&amp;rsquo;d better create a &amp;lsquo;shortcut&amp;rsquo; for searching the sub-cluster through &lt;code>make gen-clusterconfig&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ make gen-clusterconfigs
./hack/gen-clusterconfigs.sh
Current Context: kubernetes-admin@kubernetes
Current Cluster: kubernetes
Server: https://10.6.11.11:6443
TLS Server Name:
Insecure Skip TLS Verify:
Certificate Authority:
Certificate Authority Data: ***
Cluster &lt;span style="color:#4e9a06">&amp;#34;clusterpedia&amp;#34;&lt;/span> set.
Cluster &lt;span style="color:#4e9a06">&amp;#34;cluster-1&amp;#34;&lt;/span> set.
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Use the &lt;code>kubectl config get-clusters&lt;/code> command to view the currently supported clusters.&lt;/p>
&lt;p>In this case, Clusterpedia is a special cluster used to search for multi-clusters by using &lt;code>kubectl --cluster clusterpedia&lt;/code>.&lt;/p>
&lt;h3 id="multi-cluster-resource-search">Multi-cluster resource search&lt;/h3>
&lt;p>First check which resources are synchronized. You cannot find a resource until it is properly synchronized:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl --cluster clusterpedia api-resources
NAME SHORTNAMES APIVERSION NAMESPACED KIND
pods po v1 &lt;span style="color:#204a87">true&lt;/span> Pod
deployments deploy apps/v1 &lt;span style="color:#204a87">true&lt;/span> Deployment
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can check the currently synchronized resources including pods and deployments.apps.&lt;/p>
&lt;p>&lt;strong>Get deployments in the &lt;code>kube-system&lt;/code> namespace of all clusters:&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl --cluster clusterpedia get deployments -n kube-system
CLUSTER NAME READY UP-TO-DATE AVAILABLE AGE
cluster-1 coredns 2/2 &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> 68d
cluster-2 calico-kube-controllers 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 64d
cluster-2 coredns 2/2 &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> 64d
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>Get deployments in the two namespaces &lt;code>kube-system&lt;/code> and &lt;code>default&lt;/code> of all clusters:&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl --cluster clusterpedia get deployments -A -l &lt;span style="color:#4e9a06">&amp;#34;search.clusterpedia.io/namespaces in (kube-system, default)&amp;#34;&lt;/span>
NAMESPACE CLUSTER NAME READY UP-TO-DATE AVAILABLE AGE
kube-system cluster-1 coredns 2/2 &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> 68d
kube-system cluster-2 calico-kube-controllers 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 64d
kube-system cluster-2 coredns 2/2 &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> 64d
default cluster-2 dd-airflow-scheduler 0/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> 54d
default cluster-2 dd-airflow-web 0/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> 54d
default cluster-2 hello-world-server 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 27d
default cluster-2 keycloak 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 52d
default cluster-2 keycloak-02 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 41d
default cluster-2 my-nginx 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 40d
default cluster-2 nginx-dev 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 15d
default cluster-2 openldap 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 41d
default cluster-2 phpldapadmin 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 41d
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>Get deployments in the &lt;code>kube-system&lt;/code> and &lt;code>default&lt;/code> namespaces in cluster-1 and cluster-2:&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl --cluster clusterpedia get deployments -A -l &lt;span style="color:#4e9a06">&amp;#34;search.clusterpedia.io/clusters in (cluster-1, cluster-2),\
&lt;/span>&lt;span style="color:#4e9a06">search.clusterpedia.io/namespaces in (kube-system,default)&amp;#34;&lt;/span>
NAMESPACE CLUSTER NAME READY UP-TO-DATE AVAILABLE AGE
kube-system cluster-1 coredns 2/2 &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> 68d
kube-system cluster-2 calico-kube-controllers 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 64d
kube-system cluster-2 coredns 2/2 &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> 64d
default cluster-2 dd-airflow-scheduler 0/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> 54d
default cluster-2 dd-airflow-web 0/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> 54d
default cluster-2 hello-world-server 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 27d
default cluster-2 keycloak 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 52d
default cluster-2 keycloak-02 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 41d
default cluster-2 my-nginx 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 40d
default cluster-2 nginx-dev 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 15d
default cluster-2 openldap 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 41d
default cluster-2 phpldapadmin 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 41d
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>Get deployments in the &lt;code>kube-system&lt;/code> and &lt;code>default&lt;/code> namespaces in cluster-1 and cluster-2:&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl --cluster clusterpedia get deployments -A -l &lt;span style="color:#4e9a06">&amp;#34;search.clusterpedia.io/clusters in (cluster-1, cluster-2),\
&lt;/span>&lt;span style="color:#4e9a06">search.clusterpedia.io/namespaces in (kube-system,default),\
&lt;/span>&lt;span style="color:#4e9a06">search.clusterpedia.io/orderby=name&amp;#34;&lt;/span>
NAMESPACE CLUSTER NAME READY UP-TO-DATE AVAILABLE AGE
kube-system cluster-2 calico-kube-controllers 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 64d
kube-system cluster-1 coredns 2/2 &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> 68d
kube-system cluster-2 coredns 2/2 &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> 64d
default cluster-2 dao-2048-2048 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 21d
default cluster-2 dd-airflow-scheduler 0/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> 54d
default cluster-2 dd-airflow-web 0/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> 54d
default cluster-2 hello-world-server 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 27d
default cluster-2 keycloak 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 52d
default cluster-2 keycloak-02 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 41d
default cluster-2 my-nginx 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 40d
default cluster-2 nginx-dev 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 15d
default cluster-2 openldap 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 41d
default cluster-2 phpldapadmin 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 41d
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="search-a-specific-cluster">Search a specific cluster&lt;/h3>
&lt;p>&lt;strong>If you want to search a specific cluster for any resource therein, you can add &amp;ndash;cluster to specify the cluster name:&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl --cluster cluster-1 get deployments -A
NAMESPACE CLUSTER NAME READY UP-TO-DATE AVAILABLE AGE
calico-apiserver cluster-1 calico-apiserver 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 68d
calico-system cluster-1 calico-kube-controllers 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 68d
calico-system cluster-1 calico-typha 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 68d
capi-system cluster-1 capi-controller-manager 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 42d
capi-kubeadm-bootstrap-system cluster-1 capi-kubeadm-bootstrap-controller-manager 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 42d
capi-kubeadm-control-plane-system cluster-1 capi-kubeadm-control-plane-controller-manager 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 42d
capv-system cluster-1 capv-controller-manager 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 42d
cert-manager cluster-1 cert-manager 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 42d
cert-manager cluster-1 cert-manager-cainjector 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 42d
cert-manager cluster-1 cert-manager-webhook 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 42d
clusterpedia-system cluster-1 clusterpedia-apiserver 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 27m
clusterpedia-system cluster-1 clusterpedia-clustersynchro-manager 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 27m
clusterpedia-system cluster-1 clusterpedia-internalstorage-mysql 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 29m
kube-system cluster-1 coredns 2/2 &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> 68d
tigera-operator cluster-1 tigera-operator 1/1 &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> 68d
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Except for &lt;code>search.clusterpedia.io/clusters&lt;/code>, the support for other complex queries is same as that for multi-cluster search.&lt;/p>
&lt;p>If you want to learn about the details of a resource, you need to specify which cluster it is:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl --cluster cluster-1 -n kube-system get deployments coredns -o wide
CLUSTER NAME READY UP-TO-DATE AVAILABLE AGE CONTAINERS IMAGES SELECTOR
cluster-1 coredns 2/2 &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> 68d coredns registry.aliyuncs.com/google_containers/coredns:v1.8.4 k8s-app&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>kube-dns
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="complex-search">Complex search&lt;/h3>
&lt;p>Clusterpedia supports for the following complex search:&lt;/p>
&lt;ul>
&lt;li>Specify one or more &lt;code>cluster names&lt;/code>&lt;/li>
&lt;li>Specify one or more &lt;code>namespaces&lt;/code>&lt;/li>
&lt;li>Specify one or more &lt;code>resource names&lt;/code>&lt;/li>
&lt;li>Specify how to &lt;code>sort&lt;/code> multiple fields&lt;/li>
&lt;li>&lt;code>Paging&lt;/code> function, by which you can specify its size and offset&lt;/li>
&lt;li>&lt;code>filter by labels&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>The actual effect of field sorting depends on the storage layer. By default, the storage layer supports for sorting according to &lt;code>cluster&lt;/code>, &lt;code>name&lt;/code>, &lt;code>namespace&lt;/code>, &lt;code>created_at&lt;/code>, and &lt;code>resource_version&lt;/code> in a normal or reverse order.&lt;/p>
&lt;h3 id="how-search-conditions-are-applied">How search conditions are applied&lt;/h3>
&lt;p>The above example demonstrates how you can use kubectl to search for resources. Where, complex search conditions are applied via a &lt;code>label&lt;/code>. Clusterpedia also supports for using these search conditions directly through &lt;code>url query&lt;/code>.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>role&lt;/th>
&lt;th>label key&lt;/th>
&lt;th>url query&lt;/th>
&lt;th>example&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Specified resource name&lt;/td>
&lt;td>search.clusterpedia.io/names&lt;/td>
&lt;td>names&lt;/td>
&lt;td>&lt;code>?names=pod-1,pod-2&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Specified namespace&lt;/td>
&lt;td>search.clusterpedia.io/namespaces&lt;/td>
&lt;td>namespaces&lt;/td>
&lt;td>&lt;code>?namespaces=kube-system,default&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Specified cluster name&lt;/td>
&lt;td>search.clusterpedia.io/clusters&lt;/td>
&lt;td>clusters&lt;/td>
&lt;td>&lt;code>?clusters=cluster-1,cluster-2&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Sort by specified fileds&lt;/td>
&lt;td>search.clusterpedia.io/orderby&lt;/td>
&lt;td>orderby&lt;/td>
&lt;td>&lt;code>?orderby=name desc,namespace&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Specified size&lt;/td>
&lt;td>search.clusterpedia.io/size&lt;/td>
&lt;td>size&lt;/td>
&lt;td>&lt;code>?size=100&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Specified offset&lt;/td>
&lt;td>search.clsuterpedia.io/offset&lt;/td>
&lt;td>offset&lt;/td>
&lt;td>&lt;code>?offset=10&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>The operators of &lt;code>label key&lt;/code> include ==, =, !=, in, not in. For the &lt;code>size&lt;/code> condition, kubectl can specify a size by &lt;code>--chunk-size&lt;/code> instead of the &lt;code>label key&lt;/code>.&lt;/p>
&lt;h3 id="collection-resource">Collection Resource&lt;/h3>
&lt;p>Clusterpedia can also perform more advanced aggregation of resources. For example, you can use &lt;code>Collection Resource&lt;/code> to get a set of different resources at once.&lt;/p>
&lt;p>Let&amp;rsquo;s first check which &lt;code>Collection Resource&lt;/code> currently Clusterpedia supports:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl get collectionresources
NAME RESOURCES
workloads deployments.apps,daemonsets.apps,statefulsets.apps
&lt;/code>&lt;/pre>&lt;/div>&lt;p>By getting workloads, you can get a set of resources aggregated by deployment, daemonset, and statefulset, and &lt;code>Collection Resource&lt;/code> also supports for all complex queries.&lt;/p>
&lt;p>&lt;strong>&lt;code>kubectl get collectionresources workloads&lt;/code> will get the corresponding resources of all namespaces in all clusters by default:&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">$ kubectl get collectionresources workloads
CLUSTER GROUP VERSION KIND NAMESPACE NAME AGE
cluster-1 apps v1 DaemonSet kube-system vsphere-cloud-controller-manager 63d
cluster-2 apps v1 Deployment kube-system calico-kube-controllers 109d
cluster-2 apps v1 Deployment kube-system coredns-coredns 109d
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>Add the collection of Daemonset in cluster-1 and some of the above output is cut out&lt;/p>
&lt;/blockquote>
&lt;p>Due to the limitation of kubectl, you cannot use complex queries in kubectl and can only be queried by &lt;code>url query&lt;/code>.&lt;/p>
&lt;h2 id="proposal">Proposal&lt;/h2>
&lt;h3 id="perform-more-complex-control-over-resourcesspan-idcomplicatedspan">Perform more complex control over resources&lt;span id="complicated">&lt;/span>&lt;/h3>
&lt;p>In addition to resource search, similar to Wikipedia, Clusterpedia should also have simple capability of resource control, such as watch, create, delete, update, and more.&lt;/p>
&lt;p>In fact, a write action is implemented by double write + response.&lt;/p>
&lt;p>&lt;strong>We will discuss this feature and decide whether we should implement it according to the community needs&lt;/strong>&lt;/p>
&lt;h3 id="automatic-discovery-and-resource-synchronizationspan-iddiscoveryspan">Automatic discovery and resource synchronization&lt;span id="discovery">&lt;/span>&lt;/h3>
&lt;p>The resource used to represent the cluster in Clusterpedia is called &lt;em>PediaCluster&lt;/em>, not a simple Cluster.&lt;/p>
&lt;p>**This is because Clusterpedia was originally designed to build on the existing multi-cluster management platform. **&lt;/p>
&lt;p>In order to keep the original intention, the first issue is that Clusterpedia should not conflict with the resources in the existing multi-cluster platform. Cluster is a very common resource name that represents a cluster.&lt;/p>
&lt;p>In addition, in order to better connect with the existing multi-cluster platform and enable the connected clusters automatically complete resource synchronization, we need a new mechanism to discover clusters. This discovery mechanism needs to solve the following issues:&lt;/p>
&lt;ul>
&lt;li>Get the authentication info to access the cluster&lt;/li>
&lt;li>Configure conditions that trigger the lifecycle of PediaCluster&lt;/li>
&lt;li>Set the default policy and prefix name for resource synchronization&lt;/li>
&lt;/ul>
&lt;p>This feature will be discussed and implemented in detail in Q1 or Q2 2022.&lt;/p>
&lt;h2 id="roadmapspan-idroadmapspan">Roadmap&lt;span id="roadmap">&lt;/span>&lt;/h2>
&lt;p>Currently, it is only a tentative roadmap and the specific schedule depends on the community needs.&lt;/p>
&lt;p>&lt;strong>About some features not added to Roadmap, you can discuss in &lt;a href="https://github.com/clusterpedia-io/clusterpedia/issues">issues&lt;/a>.&lt;/strong>&lt;/p>
&lt;h3 id="q4-2021">Q4 2021&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://github.com/clusterpedia-io/clusterpedia/issues/4">Support for cropping field&lt;/a>&lt;/li>
&lt;li>Synchronize custom resources&lt;/li>
&lt;/ul>
&lt;h3 id="q1-2022">Q1 2022&lt;/h3>
&lt;ul>
&lt;li>Support for the plug-in storage layer&lt;/li>
&lt;li>Implement &lt;a href="#discovery">automatic discovery and resource synchronization&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="q2-2022">Q2 2022&lt;/h3>
&lt;ul>
&lt;li>Support for &lt;a href="#complicated">more control over cluster resources&lt;/a>, such as watch/create/update/delete operations&lt;/li>
&lt;li>The storage layer supports for custom Collection Resource by default&lt;/li>
&lt;li>Support for requests with relevant resources&lt;/li>
&lt;/ul>
&lt;h2 id="remarks">Remarks&lt;/h2>
&lt;h3 id="multi-cluster-network-connectivity">Multi-cluster network connectivity&lt;/h3>
&lt;p>Clusterpedia does not actually solve the problem of network connectivity in a multi-cluster environment. You can use tools such as &lt;a href="https://github.com/kubesphere/tower">tower&lt;/a> to connect and access sub-clusters, or use &lt;a href="https://github.com/submariner-io/submariner">submariner&lt;/a> or &lt;a href="https://github.com/skupperproject/skupper">skupper&lt;/a> to solve cross-cluster network problems.&lt;/p></description></item></channel></rss>